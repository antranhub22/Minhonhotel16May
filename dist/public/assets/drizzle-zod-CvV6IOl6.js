import{z as I}from"./zod-C4bLmoCR.js";import{g as h,a as X,i as u,b as T,S as M,c as m,C as f}from"./drizzle-orm-DkU9nIBF.js";const l={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function N(e,r){return r.includes(e.columnType)}function p(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}const E=I.union([I.string(),I.number(),I.boolean(),I.null()]),P=I.union([E,I.record(I.any()),I.array(I.any())]),G=I.custom(e=>e instanceof Buffer);function y(e,r){const t=(r==null?void 0:r.zodInstance)??I,i=(r==null?void 0:r.coerce)??{};let n;return p(e)&&(n=e.enumValues.length?t.enum(e.enumValues):t.string()),n||(N(e,["PgGeometry","PgPointTuple"])?n=t.tuple([t.number(),t.number()]):N(e,["PgGeometryObject","PgPointObject"])?n=t.object({x:t.number(),y:t.number()}):N(e,["PgHalfVector","PgVector"])?(n=t.array(t.number()),n=e.dimensions?n.length(e.dimensions):n):N(e,["PgLine"])?n=t.tuple([t.number(),t.number(),t.number()]):N(e,["PgLineABC"])?n=t.object({a:t.number(),b:t.number(),c:t.number()}):N(e,["PgArray"])?(n=t.array(y(e.baseColumn,t)),n=e.size?n.length(e.size):n):e.dataType==="array"?n=t.array(t.any()):e.dataType==="number"?n=D(e,t,i):e.dataType==="bigint"?n=x(e,t,i):e.dataType==="boolean"?n=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?n=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?n=U(e,t,i):e.dataType==="json"?n=P:e.dataType==="custom"?n=t.any():e.dataType==="buffer"&&(n=G)),n||(n=t.any()),n}function D(e,r,t){let i=e.getSQLType().includes("unsigned"),n,s,a=!1;N(e,["MySqlTinyInt","SingleStoreTinyInt"])?(n=i?0:l.INT8_MIN,s=i?l.INT8_UNSIGNED_MAX:l.INT8_MAX,a=!0):N(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(n=i?0:l.INT16_MIN,s=i?l.INT16_UNSIGNED_MAX:l.INT16_MAX,a=!0):N(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(n=i?0:l.INT24_MIN,s=i?l.INT24_UNSIGNED_MAX:l.INT24_MAX,a=N(e,["MySqlMediumInt","SingleStoreMediumInt"])):N(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(n=i?0:l.INT32_MIN,s=i?l.INT32_UNSIGNED_MAX:l.INT32_MAX,a=!0):N(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(n=i?0:l.INT48_MIN,s=i?l.INT48_UNSIGNED_MAX:l.INT48_MAX):N(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||N(e,["MySqlSerial","SingleStoreSerial"]),n=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):N(e,["MySqlYear","SingleStoreYear"])?(n=1901,s=2155,a=!0):(n=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let S=t===!0||t!=null&&t.number?r.coerce.number():r.number();return S=S.min(n).max(s),a?S.int():S}function x(e,r,t){const i=e.getSQLType().includes("unsigned"),n=i?0n:l.INT64_MIN,s=i?l.INT64_UNSIGNED_MAX:l.INT64_MAX;return(t===!0||t!=null&&t.bigint?r.coerce.bigint():r.bigint()).min(n).max(s)}function U(e,r,t){if(N(e,["PgUUID"]))return r.string().uuid();let i,n,s=!1;N(e,["PgVarchar","SQLiteText"])?i=e.length:N(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??l.INT16_UNSIGNED_MAX:N(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=l.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=l.INT24_UNSIGNED_MAX:e.textType==="text"?i=l.INT16_UNSIGNED_MAX:i=l.INT8_UNSIGNED_MAX),N(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),N(e,["PgBinaryVector"])&&(n=/^[01]+$/,i=e.dimensions);let a=t===!0||t!=null&&t.string?r.coerce.string():r.string();return a=n?a.regex(n):a,i&&s?a.length(i):i?a.max(i):a}function b(e){return u(e)?h(e):X(e)}function o(e,r,t,i){const n={};for(const[s,a]of Object.entries(e)){if(!T(a,f)&&!T(a,M)&&!T(a,M.Aliased)&&typeof a=="object"){const A=u(a)||m(a)?b(a):a;n[s]=o(A,r[s]??{},t,i);continue}const S=r[s];if(S!==void 0&&typeof S!="function"){n[s]=S;continue}const g=T(a,f)?a:void 0,_=g?y(g,i):I.any(),d=typeof S=="function"?S(_):_;t.never(g)||(n[s]=d,g&&(t.nullable(g)&&(n[s]=n[s].nullable()),t.optional(g)&&(n[s]=n[s].optional())))}return I.object(n)}const C={never:e=>{var r,t;return((r=e==null?void 0:e.generated)==null?void 0:r.type)==="always"||((t=e==null?void 0:e.generatedIdentity)==null?void 0:t.type)==="always"},optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull},j=(e,r)=>{const t=b(e);return o(t,{},C)};export{j as c};
