import{p as A}from"./regexparam-CPXopyEH.js";import{r as o,a as B}from"./react-BlJs-Rj_.js";import{s as F}from"./use-sync-external-store-T8uco2Ip.js";const H=B.useInsertionEffect,M=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",N=M?o.useLayoutEffect:o.useEffect,V=H||N,S=e=>{const t=o.useRef([e,(...n)=>t[0](...n)]).current;return V(()=>{t[0]=e}),t[1]},T="popstate",E="pushState",P="replaceState",$="hashchange",w=[T,E,P,$],q=e=>{for(const t of w)addEventListener(t,e);return()=>{for(const t of w)removeEventListener(t,e)}},k=(e,t)=>F.useSyncExternalStore(q,e,t),z=()=>location.search,G=({ssrSearch:e=""}={})=>k(z,()=>e),R=()=>location.pathname,J=({ssrPath:e}={})=>k(R,e?()=>e:R),Q=(e,{replace:t=!1,state:n=null}={})=>history[t?P:E](n,"",e),W=(e={})=>[J(e),Q],x=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[x]>"u"){for(const e of[E,P]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),s=new Event(e);return s.arguments=arguments,dispatchEvent(s),n}}Object.defineProperty(window,x,{value:!0})}const X=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",O=(e="")=>e==="/"?"":e,Y=(e,t)=>e[0]==="~"?e.slice(1):O(t)+e,Z=(e="",t)=>X(C(O(e)),C(t)),C=e=>{try{return decodeURI(e)}catch{return e}},j={hook:W,searchHook:G,parser:A,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},I=o.createContext(j),y=()=>o.useContext(I),K={},_=o.createContext(K),ee=()=>o.useContext(_),v=e=>{const[t,n]=e.hook(e);return[Z(e.base,t),S((s,r)=>n(Y(s,e.base),r))]},D=(e,t,n,s)=>{const{pattern:r,keys:i}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",s),c=r.exec(n)||[],[f,...h]=c;return f!==void 0?[!0,(()=>{const a=i!==!1?Object.fromEntries(i.map((d,l)=>[d,h[l]])):c.groups;let u={...h};return a&&Object.assign(u,a),u})(),...s?[f]:[]]:[!1,null]},te=({children:e,...t})=>{var u,d;const n=y(),s=t.hook?j:n;let r=s;const[i,c]=((u=t.ssrPath)==null?void 0:u.split("?"))??[];c&&(t.ssrSearch=c,t.ssrPath=i),t.hrefs=t.hrefs??((d=t.hook)==null?void 0:d.hrefs);let f=o.useRef({}),h=f.current,a=h;for(let l in s){const p=l==="base"?s[l]+(t[l]||""):t[l]||s[l];h===a&&p!==a[l]&&(f.current=a={...a}),a[l]=p,p!==s[l]&&(r=a)}return o.createElement(I.Provider,{value:r,children:e})},L=({children:e,component:t},n)=>t?o.createElement(t,{params:n}):typeof e=="function"?e(n):e,ne=e=>{let t=o.useRef(K);const n=t.current;return t.current=Object.keys(e).length!==Object.keys(n).length||Object.entries(e).some(([s,r])=>r!==n[s])?e:n},ae=({path:e,nest:t,match:n,...s})=>{const r=y(),[i]=v(r),[c,f,h]=n??D(r.parser,e,i,t),a=ne({...ee(),...f});if(!c)return null;const u=h?o.createElement(te,{base:h},L(s,a)):L(s,a);return o.createElement(_.Provider,{value:a,children:u})},ce=o.forwardRef((e,t)=>{const n=y(),[s,r]=v(n),{to:i="",href:c=i,onClick:f,asChild:h,children:a,className:u,replace:d,state:l,...p}=e,g=S(m=>{m.ctrlKey||m.metaKey||m.altKey||m.shiftKey||m.button!==0||(f==null||f(m),m.defaultPrevented||(m.preventDefault(),r(c,e)))}),b=n.hrefs(c[0]==="~"?c.slice(1):n.base+c,n);return h&&o.isValidElement(a)?o.cloneElement(a,{onClick:g,href:b}):o.createElement("a",{...p,onClick:g,href:b,className:u!=null&&u.call?u(s===c):u,children:a,ref:t})}),U=e=>Array.isArray(e)?e.flatMap(t=>U(t&&t.type===o.Fragment?t.props.children:t)):[e],ue=({children:e,location:t})=>{const n=y(),[s]=v(n);for(const r of U(e)){let i=0;if(o.isValidElement(r)&&(i=D(n.parser,r.props.path,t||s,r.props.nest))[0])return o.cloneElement(r,{match:i})}return null};export{ce as L,ae as R,ue as S,ee as u};
