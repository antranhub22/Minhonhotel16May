const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CallHistoryTable-B7fOfu6G.js","assets/react-BlJs-Rj_.js","assets/@daily-co-CRt2XSsO.js","assets/wouter-DSgBA37d.js","assets/regexparam-CPXopyEH.js","assets/use-sync-external-store-T8uco2Ip.js"])))=>i.map(i=>d[i]);
import{_ as b}from"./index-B87HseW6.js";import{r as n,j as e,R as y}from"./react-BlJs-Rj_.js";import{u as j}from"./@tanstack-H40tjzcj.js";import{L as N}from"./wouter-DSgBA37d.js";import"./react-dom-qFx4IFJ8.js";import"./@daily-co-CRt2XSsO.js";import"./scheduler-DYLXRpC5.js";import"./@radix-ui-QlMI2MB_.js";import"./react-remove-scroll-BI7w_Xav.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-BrVopqW4.js";import"./react-style-singleton-QOKzqUsk.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-1JKJ7J1d.js";import"./use-callback-ref-5JKzev4p.js";import"./aria-hidden-DQ5UC2Eg.js";import"./class-variance-authority-Dp3B9jqt.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-D696Ktp4.js";import"./lucide-react-CxnTV3od.js";import"./@vapi-ai-DrvmIiYL.js";import"./events-CXH2uRM3.js";import"./react-icons-du4cCclG.js";import"./react-router-DvHbwIsR.js";import"./@remix-run-DBo92Irb.js";import"./react-router-dom-BMXKYxTf.js";import"./regexparam-CPXopyEH.js";import"./use-sync-external-store-T8uco2Ip.js";const v=y.lazy(()=>b(()=>import("./CallHistoryTable-B7fOfu6G.js"),__vite__mapDeps([0,1,2,3,4,5]))),Y=()=>{const[r,c]=n.useState(24),[a,d]=n.useState(""),{data:s,isLoading:x,isError:h,refetch:m}=j({queryKey:["summaries","recent",r],queryFn:async()=>{const t=await fetch(`/api/summaries/recent/${r}`);if(!t.ok)throw new Error("Failed to fetch recent call summaries");return t.json()}}),u=t=>(t instanceof Date?t:new Date(t)).toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=t=>{if(!t)return"00:00";const o=parseInt(t,10);if(!isNaN(o)&&/^\d+$/.test(t)){const g=Math.floor(o/60).toString().padStart(2,"0"),f=(o%60).toString().padStart(2,"0");return`${g}:${f}`}return t},l=t=>{c(t)},i=s==null?void 0:s.summaries.filter(t=>a?t.roomNumber&&t.roomNumber.toLowerCase().includes(a.toLowerCase()):!0);return e.jsxs("div",{className:"container mx-auto p-5",children:[e.jsxs("header",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-primary",children:"Call History"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(N,{to:"/",children:e.jsxs("button",{className:"px-4 py-2 rounded-md bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors flex items-center",children:[e.jsx("span",{className:"material-icons align-middle mr-1 text-sm",children:"home"}),"Home"]})}),e.jsxs("button",{onClick:()=>m(),className:"px-4 py-2 rounded-md bg-blue-100 text-blue-700 hover:bg-blue-200 transition-colors flex items-center",children:[e.jsx("span",{className:"material-icons align-middle mr-1 text-sm",children:"refresh"}),"Refresh"]})]})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm mb-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Time Period"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>l(24),className:`px-3 py-1 rounded-md ${r===24?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"24 hours"}),e.jsx("button",{onClick:()=>l(48),className:`px-3 py-1 rounded-md ${r===48?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"48 hours"}),e.jsx("button",{onClick:()=>l(72),className:`px-3 py-1 rounded-md ${r===72?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"72 hours"})]})]}),e.jsxs("div",{className:"space-y-2 md:w-1/3",children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Filter by Room"}),e.jsx("input",{type:"text",placeholder:"Enter room number...",value:a,onChange:t=>d(t.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})})]}),e.jsx("main",{children:x?e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm flex justify-center items-center h-64",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading call history..."})]})}):h?e.jsx("div",{className:"bg-red-50 p-6 rounded-lg shadow-sm flex justify-center items-center h-64",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("span",{className:"material-icons text-red-500 text-4xl mb-3",children:"error_outline"}),e.jsx("p",{className:"text-red-700 mb-2",children:"Unable to load call history"}),e.jsx("p",{className:"text-red-500 text-sm",children:"Please try again later or contact administrator."}),e.jsx("button",{onClick:()=>m(),className:"mt-4 px-4 py-2 bg-red-100 text-red-700 rounded-md hover:bg-red-200 transition-colors",children:"Try Again"})]})}):i!=null&&i.length?e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm flex justify-center items-center h-64",children:"Đang tải bảng..."}),children:e.jsx(v,{filteredSummaries:i,formatDate:u,formatDuration:p})}):e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm flex justify-center items-center h-64",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("span",{className:"material-icons text-gray-400 text-4xl mb-3",children:"history"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"No calls found"}),e.jsx("p",{className:"text-gray-400 text-sm",children:a?`No calls from room "${a}" in the last ${r} hours.`:`No calls found in the last ${r} hours.`})]})})}),e.jsx("div",{className:"mt-6 text-center text-gray-500 text-sm",children:e.jsxs("p",{children:["Showing call history from the last ",r," hours • Total: ",(s==null?void 0:s.count)||0," calls"]})})]})};export{Y as default};
//# sourceMappingURL=CallHistory-CIRaBg0a.js.map
