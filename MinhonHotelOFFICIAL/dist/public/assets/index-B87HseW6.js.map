{"version":3,"mappings":"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","names":["ErrorBoundary","Component","props","error","info","jsxs","jsx","TOAST_LIMIT","TOAST_REMOVE_DELAY","count","genId","toastTimeouts","addToRemoveQueue","toastId","timeout","dispatch","reducer","state","action","t","toast","listeners","memoryState","listener","id","update","dismiss","open","useToast","setState","React.useState","React.useEffect","index","cn","inputs","twMerge","clsx","ToastProvider","ToastPrimitives.Provider","ToastViewport","React.forwardRef","className","ref","ToastPrimitives.Viewport","toastVariants","cva","Toast","variant","ToastPrimitives.Root","ToastAction","ToastPrimitives.Action","ToastClose","ToastPrimitives.Close","X","ToastTitle","ToastPrimitives.Title","ToastDescription","ToastPrimitives.Description","Toaster","toasts","title","description","FORCE_BASIC_SUMMARY","vapiInstance","initVapi","publicKey","Vapi","volume","message","getVapiInstance","initialOrderSummary","AssistantContext","createContext","AssistantProvider","children","currentInterface","setCurrentInterface","useState","transcripts","setTranscripts","orderSummary","setOrderSummary","callDetails","setCallDetails","order","setOrder","callDuration","setCallDuration","callTimer","setCallTimer","isMuted","setIsMuted","callSummary","setCallSummary","serviceRequests","setServiceRequests","vietnameseSummary","setVietnameseSummary","emailSentForCurrentSession","setEmailSentForCurrentSession","requestReceivedAt","setRequestReceivedAt","activeOrders","setActiveOrders","stored","o","err","micLevel","setMicLevel","modelOutput","setModelOutput","language","setLanguage","useEffect","addActiveOrder","prev","addTranscript","React","transcript","newTranscript","vapi","timer","newDuration","toggleMute","startCall","callId","assistantId","endCall","useCallback","updates","formattedDuration","transcriptData","noTranscriptSummary","loadingSummary","response","data","summaryContent","ReactDOM","aiSummary","errorSummary","value","text","output","useAssistant","context","useContext","resources","en","fr","zh","ru","ko","key","lang","Step","memo","step","currentStep","compact","horizontal","isActive","isCompleted","iconStyle","useMemo","iconClasses","titleClasses","descClasses","containerClasses","InfographicSteps","propLanguage","contextLanguage","steps","idx","useWebSocket","socket","setSocket","connected","setConnected","retryRef","useRef","initWebSocket","wsUrl","newSocket","event","delay","sendMessage","reconnect","Image","src","alt","fallbackSrc","loading","width","height","imgSrc","setImgSrc","isLoading","setIsLoading","setError","handleError","Dialog","DialogPrimitive.Root","DialogPortal","DialogPrimitive.Portal","DialogOverlay","DialogPrimitive.Overlay","DialogContent","DialogPrimitive.Content","DialogPrimitive.Close","DialogHeader","DialogFooter","DialogTitle","DialogPrimitive.Title","DialogDescription","DialogPrimitive.Description","buttonVariants","Button","size","asChild","Comp","Slot","BLUE_LAGOON_COLORS","OnboardingModal","assistantContext","setOpen","handleClose","handleShowGuide","Fragment","FaQuestionCircle","FaPhoneAlt","FaCheckCircle","FaPaperPlane","CHECK_INTERVAL","VersionChecker","show","setShow","latest","setLatest","currentVersion","fetchVersion","interval","Interface1","lazy","__vitePreload","Interface2","Interface3","Interface3Vi","Interface3Fr","Interface4","LoadingFallback","Header","Link","History","InterfaceContainer","Suspense","VoiceAssistant","Card","CardHeader","CardTitle","CardDescription","CardContent","CardFooter","NotFound","AlertCircle","EmailTester","sending","setSending","result","setResult","email","setEmail","sendTestEmail","isMobile","timestamp","mobileData","mobileErr","e","StaffLogin","onLogin","username","setUsername","password","setPassword","handleSubmit","res","statusOptions","StaffRequestDetailModal","request","onClose","onStatusChange","onOpenMessage","pendingStatus","setPendingStatus","opt","StaffMessagePopup","messages","onSend","input","setInput","handleSend","msg","statusColor","status","StaffRequestTable","StaffDashboard","requests","setRequests","selectedRequest","setSelectedRequest","showDetailModal","setShowDetailModal","showMessagePopup","setShowMessagePopup","setMessages","loadingMsg","setLoadingMsg","statusFilter","setStatusFilter","startDate","setStartDate","endDate","setEndDate","expandedContent","setExpandedContent","isDeleting","setIsDeleting","showPasswordDialog","setShowPasswordDialog","deletePassword","setDeletePassword","passwordError","setPasswordError","navigate","useNavigate","getToken","fetchRequests","token","intervalId","handleCloseDetail","handleStatusChange","reqId","reqs","r","handleOpenMessage","handleCloseMessage","handleSendMessage","msgs","handleDeleteAllRequests","confirmDelete","filteredRequests","requestDate","filterStartDate","filterEndDate","handlePasswordKeyDown","handleDialogClick","a","b","req","s","newStatus","_","rest","StaffPage","isLoggedIn","setIsLoggedIn","handleLoginSuccess","CallHistory","CallDetails","EmailTestPage","Router","Switch","Route","App","BrowserRouter","throwIfResNotOk","getQueryFn","unauthorizedBehavior","queryKey","queryClient","QueryClient","createRoot","QueryClientProvider"],"ignoreList":[],"sources":["../../../client/src/components/ErrorBoundary.tsx","../../../client/src/hooks/use-toast.ts","../../../client/src/lib/utils.ts","../../../client/src/components/ui/toast.tsx","../../../client/src/components/ui/toaster.tsx","../../../client/src/lib/vapiClient.ts","../../../client/src/context/AssistantContext.tsx","../../../client/src/i18n/index.ts","../../../client/src/components/InfographicSteps.tsx","../../../client/src/hooks/useWebSocket.ts","../../../client/src/components/ui/Image.tsx","../../../client/src/components/ui/dialog.tsx","../../../client/src/components/ui/button.tsx","../../../client/src/components/OnboardingModal.tsx","../../../client/src/components/VersionChecker.tsx","../../../client/src/components/VoiceAssistant.tsx","../../../client/src/components/ui/card.tsx","../../../client/src/pages/not-found.tsx","../../../client/src/components/EmailTester.tsx","../../../client/src/pages/StaffLogin.tsx","../../../client/src/components/StaffRequestDetailModal.tsx","../../../client/src/components/StaffMessagePopup.tsx","../../../client/src/pages/StaffDashboard.tsx","../../../client/src/pages/staff.tsx","../../../client/src/App.tsx","../../../client/src/lib/queryClient.ts","../../../client/src/main.tsx"],"sourcesContent":["import React, { Component, ReactNode, ErrorInfo } from 'react';\n\ninterface ErrorBoundaryProps {\n  children: ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error: Error | null;\n}\n\nclass ErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = { hasError: false, error: null };\n  }\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, info: ErrorInfo) {\n    console.error('Uncaught error in component tree:', error, info);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"flex items-center justify-center h-screen p-4 bg-gray-50\">\n          <div className=\"max-w-md text-center\">\n            <h1 className=\"text-2xl font-bold text-red-600 mb-2\">Something went wrong.</h1>\n            <p className=\"text-gray-700 mb-4\">An unexpected error occurred. Please try refreshing the page or contact support if the problem persists.</p>\n            <button\n              onClick={() => window.location.reload()}\n              className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\n            >\n              Reload Page\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary; ","import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n","import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-dark\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-dark/50 opacity-0 transition-opacity hover:text-dark focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","import Vapi from '@vapi-ai/web';\n\n// Initialize with environment variable or fallback\nconst PUBLIC_KEY = import.meta.env.VITE_VAPI_PUBLIC_KEY || 'demo';\nconst MAX_RETRIES = 3;\nconst RETRY_DELAY = 1000; // 1 second\n\n// Option to force basic summary generation (for testing fallback)\nexport const FORCE_BASIC_SUMMARY = false; // Set to true to always use basic summary\n\n// Define message types based on Vapi's API\ntype MessageRole = 'system' | 'user' | 'assistant' | 'tool' | 'function';\n\ninterface Message {\n  role: MessageRole;\n  content: string;\n}\n\ninterface AddMessage {\n  type: 'add-message';\n  message: Message;\n}\n\nlet vapiInstance: Vapi | null = null;\n\ninterface VapiConnectionStatus {\n  status: 'connecting' | 'connected' | 'disconnected';\n}\n\ninterface VapiMessage {\n  type: string;\n  content?: string;\n  [key: string]: any;\n}\n\nexport const initVapi = async (publicKey: string): Promise<Vapi> => {\n  try {\n    if (vapiInstance) {\n      return vapiInstance;\n    }\n    vapiInstance = new Vapi(publicKey);\n\n    // Add event listeners\n    vapiInstance.on('call-start', () => {\n      console.log('Call started');\n    });\n\n    vapiInstance.on('call-end', () => {\n      console.log('Call ended');\n    });\n\n    vapiInstance.on('speech-start', () => {\n      console.log('Speech started');\n    });\n\n    vapiInstance.on('speech-end', () => {\n      console.log('Speech ended');\n    });\n\n    vapiInstance.on('volume-level', (volume) => {\n      console.log(`Volume level: ${volume}`);\n    });\n\n    vapiInstance.on('message', (message) => {\n      console.log('Message received:', message);\n    });\n\n    vapiInstance.on('error', (error) => {\n      console.error('Error:', error);\n    });\n\n    return vapiInstance;\n  } catch (error) {\n    console.error('Failed to initialize Vapi:', error);\n    throw error;\n  }\n};\n\nexport const getVapiInstance = (): Vapi | null => {\n  return vapiInstance;\n};\n\nexport const isVapiInitialized = (): boolean => {\n  return vapiInstance !== null;\n};\n\nexport const startCall = async (assistantId: string, assistantOverrides?: any) => {\n  if (!vapiInstance) {\n    throw new Error('Vapi not initialized. Call initVapi first.');\n  }\n\n  try {\n    const call = await vapiInstance.start(assistantId, assistantOverrides);\n    return call;\n  } catch (error) {\n    console.error('Failed to start call:', error);\n    throw error;\n  }\n};\n\nexport const stopCall = () => {\n  if (!vapiInstance) {\n    throw new Error('Vapi not initialized. Call initVapi first.');\n  }\n\n  try {\n    vapiInstance.stop();\n  } catch (error) {\n    console.error('Failed to stop call:', error);\n    throw error;\n  }\n};\n\nexport const setMuted = (muted: boolean) => {\n  if (!vapiInstance) {\n    throw new Error('Vapi not initialized. Call initVapi first.');\n  }\n\n  try {\n    vapiInstance.setMuted(muted);\n  } catch (error) {\n    console.error('Failed to set mute state:', error);\n    throw error;\n  }\n};\n\nexport const isMuted = (): boolean => {\n  if (!vapiInstance) {\n    throw new Error('Vapi not initialized. Call initVapi first.');\n  }\n\n  try {\n    return vapiInstance.isMuted();\n  } catch (error) {\n    console.error('Failed to get mute state:', error);\n    throw error;\n  }\n};\n\nexport const sendMessage = (content: string, role: 'system' | 'user' = 'system') => {\n  if (!vapiInstance) {\n    throw new Error('Vapi not initialized. Call initVapi first.');\n  }\n\n  try {\n    vapiInstance.send({\n      type: 'add-message',\n      message: {\n        role,\n        content\n      }\n    });\n  } catch (error) {\n    console.error('Failed to send message:', error);\n    throw error;\n  }\n};\n\nexport const say = (message: string, endCallAfterSpoken?: boolean) => {\n  if (!vapiInstance) {\n    throw new Error('Vapi not initialized. Call initVapi first.');\n  }\n\n  try {\n    vapiInstance.say(message, endCallAfterSpoken);\n  } catch (error) {\n    console.error('Failed to say message:', error);\n    throw error;\n  }\n};\n\nexport const buttonConfig = {\n  position: \"top\",\n  offset: \"240px\",\n  width: \"120px\",\n  height: \"120px\",\n  idle: {\n    color: `rgb(93, 254, 202)`,\n    type: \"round\",\n    title: \"Have a quick question?\",\n    subtitle: \"Talk with our AI assistant\",\n    icon: `https://unpkg.com/lucide-static@0.321.0/icons/phone.svg`,\n  },\n  loading: {\n    color: `rgb(93, 124, 202)`,\n    type: \"round\",\n    title: \"Connecting...\",\n    subtitle: \"Please wait\",\n    icon: `https://unpkg.com/lucide-static@0.321.0/icons/loader-2.svg`,\n  },\n  active: {\n    color: `rgb(255, 0, 0)`,\n    type: \"round\",\n    title: \"Call is in progress...\",\n    subtitle: \"End the call.\",\n    icon: `https://unpkg.com/lucide-static@0.321.0/icons/phone-off.svg`,\n  },\n};\n","import React, { createContext, useContext, useState, useEffect, ReactNode, useCallback } from 'react';\nimport { Transcript, OrderSummary, CallDetails, Order, InterfaceLayer, CallSummary, ServiceRequest, ActiveOrder, Language } from '@/types';\nimport { initVapi, getVapiInstance, FORCE_BASIC_SUMMARY } from '@/lib/vapiClient';\nimport { apiRequest } from '@/lib/queryClient';\nimport { parseSummaryToOrderDetails } from '@/lib/summaryParser';\nimport ReactDOM from 'react-dom';\n\ninterface AssistantContextType {\n  currentInterface: InterfaceLayer;\n  setCurrentInterface: (layer: InterfaceLayer) => void;\n  transcripts: Transcript[];\n  setTranscripts: (transcripts: Transcript[]) => void;\n  addTranscript: (transcript: Omit<Transcript, 'id' | 'timestamp'>) => void;\n  orderSummary: OrderSummary | null;\n  setOrderSummary: (summary: OrderSummary) => void;\n  callDetails: CallDetails | null;\n  setCallDetails: (details: CallDetails) => void;\n  order: Order | null;\n  setOrder: (order: Order) => void;\n  callDuration: number;\n  setCallDuration: (duration: number) => void;\n  isMuted: boolean;\n  toggleMute: () => void;\n  startCall: () => Promise<void>;\n  endCall: () => void;\n  callSummary: CallSummary | null;\n  setCallSummary: (summary: CallSummary) => void;\n  serviceRequests: ServiceRequest[];\n  setServiceRequests: (requests: ServiceRequest[]) => void;\n  vietnameseSummary: string | null;\n  setVietnameseSummary: (summary: string) => void;\n  translateToVietnamese: (text: string) => Promise<string>;\n  emailSentForCurrentSession: boolean;\n  setEmailSentForCurrentSession: (sent: boolean) => void;\n  requestReceivedAt: Date | null;\n  setRequestReceivedAt: (date: Date | null) => void;\n  activeOrders: ActiveOrder[];\n  addActiveOrder: (order: ActiveOrder) => void;\n  micLevel: number;\n  modelOutput: string[];\n  setModelOutput: (output: string[]) => void;\n  addModelOutput: (output: string) => void;\n  language: Language;\n  setLanguage: (lang: Language) => void;\n}\n\nconst initialOrderSummary: OrderSummary = {\n  orderType: 'Room Service',\n  deliveryTime: 'asap',\n  roomNumber: '',\n  guestName: '',\n  guestEmail: '',\n  guestPhone: '',\n  specialInstructions: '',\n  items: [\n    {\n      id: '1',\n      name: 'Club Sandwich',\n      description: 'Served with french fries and side salad',\n      quantity: 1,\n      price: 15.00\n    },\n    {\n      id: '2', \n      name: 'Fresh Orange Juice',\n      description: 'Large size',\n      quantity: 1,\n      price: 8.00\n    }\n  ],\n  totalAmount: 23.00\n};\n\n// Context definition\nconst AssistantContext = createContext<AssistantContextType | undefined>(undefined);\n\nexport function AssistantProvider({ children }: { children: ReactNode }) {\n  const [currentInterface, setCurrentInterface] = useState<InterfaceLayer>('interface1');\n  const [transcripts, setTranscripts] = useState<Transcript[]>([]);\n  const [orderSummary, setOrderSummary] = useState<OrderSummary | null>(null);\n  const [callDetails, setCallDetails] = useState<CallDetails | null>(null);\n  const [order, setOrder] = useState<Order | null>(null);\n  const [callDuration, setCallDuration] = useState(0);\n  const [callTimer, setCallTimer] = useState<NodeJS.Timeout | null>(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [callSummary, setCallSummary] = useState<CallSummary | null>(null);\n  const [serviceRequests, setServiceRequests] = useState<ServiceRequest[]>([]);\n  const [vietnameseSummary, setVietnameseSummary] = useState<string | null>(null);\n  const [emailSentForCurrentSession, setEmailSentForCurrentSession] = useState<boolean>(false);\n  const [requestReceivedAt, setRequestReceivedAt] = useState<Date | null>(null);\n  const [activeOrders, setActiveOrders] = useState<ActiveOrder[]>(() => {\n    if (typeof window === 'undefined') return [];\n    try {\n      const stored = localStorage.getItem('activeOrders');\n      if (!stored) return [];\n      const parsed = JSON.parse(stored) as (ActiveOrder & { requestedAt: string })[];\n      return parsed.map(o => ({\n        ...o,\n        requestedAt: new Date(o.requestedAt)\n      }));\n    } catch (err) {\n      console.error('Failed to parse activeOrders from localStorage', err);\n      return [];\n    }\n  });\n  const [micLevel, setMicLevel] = useState<number>(0);\n  const [modelOutput, setModelOutput] = useState<string[]>([]);\n  const [language, setLanguage] = useState<Language>('en');\n\n  // Persist activeOrders to localStorage whenever it changes\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    try {\n      localStorage.setItem('activeOrders', JSON.stringify(activeOrders));\n    } catch {\n      console.error('Failed to persist activeOrders to localStorage');\n    }\n  }, [activeOrders]);\n\n  const addActiveOrder = (order: ActiveOrder) => {\n    setActiveOrders(prev => [...prev, {\n      ...order,\n      status: order.status || 'Đã ghi nhận'\n    }]);\n  };\n\n  // Add transcript to the list\n  const addTranscript = React.useCallback((transcript: Omit<Transcript, 'id' | 'timestamp' | 'callId'>) => {\n    const newTranscript: Transcript = {\n      ...transcript,\n      id: Date.now() as unknown as number,\n      callId: callDetails?.id || `call-${Date.now()}`,\n      timestamp: new Date()\n    };\n    setTranscripts(prev => [...prev, newTranscript]);\n  }, [callDetails?.id]);\n\n  // Initialize Vapi when component mounts\n  useEffect(() => {\n    const setupVapi = async () => {\n      try {\n        // Lấy publicKey theo ngôn ngữ\n        const publicKey = language === 'fr'\n          ? import.meta.env.VITE_VAPI_PUBLIC_KEY_FR\n          : language === 'zh'\n            ? import.meta.env.VITE_VAPI_PUBLIC_KEY_ZH\n            : language === 'ru'\n              ? import.meta.env.VITE_VAPI_PUBLIC_KEY_RU\n              : language === 'ko'\n                ? import.meta.env.VITE_VAPI_PUBLIC_KEY_KO\n                : import.meta.env.VITE_VAPI_PUBLIC_KEY;\n        if (!publicKey) {\n          throw new Error('Vapi public key is not configured');\n        }\n        \n        const vapi = await initVapi(publicKey);\n\n        // Setup event listeners after successful initialization\n        vapi.on('volume-level', (level: number) => {\n          setMicLevel(level);\n        });\n\n        // Message handler for transcripts and reports\n        const handleMessage = async (message: any) => {\n          console.log('Raw message received:', message);\n          console.log('Message type:', message.type);\n          console.log('Message role:', message.role);\n          console.log('Message content structure:', {\n            content: message.content,\n            text: message.text,\n            transcript: message.transcript\n          });\n          \n          // For model output - handle this first\n          if (message.type === 'model-output') {\n            console.log('Model output detected - Full message:', message);\n            \n            // Try to get content from any available field\n            const outputContent = message.content || message.text || message.transcript || message.output;\n            if (outputContent) {\n              console.log('Adding model output to conversation:', outputContent);\n              \n              // Add as transcript with isModelOutput flag\n              const newTranscript: Transcript = {\n                id: Date.now() as unknown as number,\n                callId: callDetails?.id || `call-${Date.now()}`,\n                role: 'assistant',\n                content: outputContent,\n                timestamp: new Date(),\n                isModelOutput: true\n              };\n              console.log('Adding new transcript for model output:', newTranscript);\n              setTranscripts(prev => {\n                const updated = [...prev, newTranscript];\n                console.log('Updated transcripts array:', updated);\n                return updated;\n              });\n            } else {\n              console.warn('Model output message received but no content found:', message);\n            }\n          }\n          \n          // Only handle user transcripts, ignore assistant transcripts\n          if (message.type === 'transcript' && message.role === 'user') {\n            console.log('Adding user transcript:', message);\n            const newTranscript: Transcript = {\n              id: Date.now() as unknown as number,\n              callId: callDetails?.id || `call-${Date.now()}`,\n              role: 'user',\n              content: message.content || message.transcript || '',\n              timestamp: new Date()\n            };\n            setTranscripts(prev => [...prev, newTranscript]);\n          }\n        };\n        \n        vapi.on('message', handleMessage);\n      } catch (error) {\n        console.error('Error setting up Vapi:', error);\n      }\n    };\n\n    setupVapi();\n    \n    return () => {\n      const vapi = getVapiInstance();\n      if (vapi) {\n        vapi.stop();\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (currentInterface === 'interface2') {\n      // Start call timer when in interface2\n      console.log('Starting call duration timer in interface2');\n      const timer = setInterval(() => {\n        setCallDuration(prev => {\n          const newDuration = prev + 1;\n          console.log('Call duration updated:', newDuration);\n          return newDuration;\n        });\n      }, 1000);\n      setCallTimer(timer);\n    } else {\n      // Clear timer when not in interface2\n      if (callTimer) {\n        console.log('Clearing call duration timer when leaving interface2');\n        clearInterval(callTimer);\n        setCallTimer(null);\n      }\n    }\n\n    return () => {\n      if (callTimer) {\n        console.log('Cleaning up call duration timer');\n        clearInterval(callTimer);\n      }\n    };\n  }, [currentInterface, callTimer]);\n\n  // Format duration for display\n  const formatDuration = (seconds: number) => {\n    const minutes = Math.floor(seconds / 60).toString().padStart(2, '0');\n    const secs = (seconds % 60).toString().padStart(2, '0');\n    return `${minutes}:${secs}`;\n  };\n\n  // Toggle mute state\n  const toggleMute = () => {\n    const vapi = getVapiInstance();\n    if (vapi) {\n      vapi.setMuted(!isMuted);\n      setIsMuted(!isMuted);\n    }\n  };\n\n  // Start call function\n  const startCall = React.useCallback(async () => {\n    try {\n      // Reset email sent flag for new session\n      setEmailSentForCurrentSession(false);\n      \n      // Reset call details\n      const callId = `call-${Date.now()}`;\n      setCallDetails({\n        id: callId,\n        roomNumber: '',\n        duration: '0',\n        category: ''\n      });\n      \n      // Clear previous transcripts and model outputs\n      setTranscripts([]);\n      setModelOutput([]);\n      \n      // Initialize Vapi\n      const vapi = getVapiInstance();\n      if (!vapi) {\n        console.error('Vapi instance not initialized');\n        return;\n      }\n\n      // Lấy assistantId theo ngôn ngữ\n      const assistantId = language === 'fr'\n        ? import.meta.env.VITE_VAPI_ASSISTANT_ID_FR\n        : language === 'zh'\n          ? import.meta.env.VITE_VAPI_ASSISTANT_ID_ZH\n          : language === 'ru'\n            ? import.meta.env.VITE_VAPI_ASSISTANT_ID_RU\n            : language === 'ko'\n              ? import.meta.env.VITE_VAPI_ASSISTANT_ID_KO\n              : import.meta.env.VITE_VAPI_ASSISTANT_ID;\n      if (!assistantId) {\n        console.error('Assistant ID not configured');\n        return;\n      }\n\n      // Start the call\n      const call = await vapi.start(assistantId);\n      if (!call) {\n        console.error('Failed to start call - call object is null');\n        return;\n      }\n\n      console.log('Call started successfully');\n\n      // Reset call duration to 0\n      setCallDuration(0);\n\n      // Start call duration timer\n      const timer = setInterval(() => {\n        setCallDuration(prev => prev + 1);\n      }, 1000);\n\n      // Store timer ID for cleanup\n      setCallTimer(timer);\n\n      // Update interface to show call in progress\n      setCurrentInterface('interface2');\n\n    } catch (error) {\n      console.error('Error starting call:', error);\n    }\n  }, []);\n\n  // End call function\n  const endCall = useCallback(() => {\n    try {\n    const vapi = getVapiInstance();\n    if (vapi) {\n      vapi.stop();\n    }\n    \n      // Batch state updates\n      const updates = () => {\n    // Stop the timer\n    if (callTimer) {\n      clearInterval(callTimer);\n      setCallTimer(null);\n    }\n    \n    // Initialize with default values\n    setOrderSummary(initialOrderSummary);\n    \n    // Format call duration for API\n    const formattedDuration = callDuration ? \n      `${Math.floor(callDuration / 60)}:${(callDuration % 60).toString().padStart(2, '0')}` : \n      '0:00';\n    \n    // Prepare transcripts for the API\n        const transcriptData = transcripts.map((message: Transcript) => ({\n      role: message.role,\n      content: message.content\n    }));\n    \n    // Check if we have enough transcript data\n    if (transcriptData.length < 2) {\n      const noTranscriptSummary: CallSummary = {\n        id: Date.now() as unknown as number,\n        callId: callDetails?.id || `call-${Date.now()}`,\n        content: \"Call was too short to generate a summary. Please try a more detailed conversation.\",\n        timestamp: new Date()\n      };\n      setCallSummary(noTranscriptSummary);\n      setCurrentInterface('interface3');\n      return;\n    }\n    \n    // Show loading state for summary\n    const loadingSummary: CallSummary = {\n      id: Date.now() as unknown as number,\n      callId: callDetails?.id || `call-${Date.now()}`,\n      content: \"Generating AI summary of your conversation...\",\n      timestamp: new Date()\n    };\n    setCallSummary(loadingSummary);\n    \n    // Send transcript data to server for OpenAI processing\n    fetch('/api/store-summary', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        summary: '', \n        transcripts: transcriptData,\n        timestamp: new Date().toISOString(),\n        callId: callDetails?.id || `call-${Date.now()}`,\n        callDuration: formattedDuration,\n        forceBasicSummary: FORCE_BASIC_SUMMARY,\n        language\n      }),\n    })\n    .then(response => {\n      if (!response.ok) {\n        throw new Error(`Network response was not ok: ${response.status}`);\n      }\n      return response.json();\n    })\n    .then(data => {\n      if (data.success && data.summary && data.summary.content) {\n        const summaryContent = data.summary.content;\n        \n            // Batch state updates for summary\n            ReactDOM.unstable_batchedUpdates(() => {\n        const aiSummary: CallSummary = {\n          id: Date.now() as unknown as number,\n          callId: callDetails?.id || `call-${Date.now()}`,\n          content: summaryContent,\n          timestamp: new Date(data.summary.timestamp || Date.now())\n        };\n        setCallSummary(aiSummary);\n        \n        if (data.serviceRequests && Array.isArray(data.serviceRequests) && data.serviceRequests.length > 0) {\n          setServiceRequests(data.serviceRequests);\n        }\n        \n              setCurrentInterface('interface3');\n            });\n      }\n    })\n    .catch(error => {\n          console.error('Error processing summary:', error);\n          // Show error state\n          const errorSummary: CallSummary = {\n        id: Date.now() as unknown as number,\n        callId: callDetails?.id || `call-${Date.now()}`,\n            content: \"An error occurred while generating the call summary.\",\n        timestamp: new Date()\n      };\n          setCallSummary(errorSummary);\n    setCurrentInterface('interface3');\n        });\n      };\n      \n      // Execute all state updates in one batch\n      ReactDOM.unstable_batchedUpdates(updates);\n      \n    } catch (error) {\n      console.error('Error in endCall:', error);\n      setCurrentInterface('interface1');\n    }\n  }, [callTimer, callDuration, transcripts, callDetails, setCallSummary, setCurrentInterface, setServiceRequests, language]);\n\n  // Function to translate text to Vietnamese\n  const translateToVietnamese = async (text: string): Promise<string> => {\n    try {\n      console.log('Requesting Vietnamese translation for summary...');\n      const response = await fetch('/api/translate-to-vietnamese', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ text }),\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Network response was not ok: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      \n      if (data.success && data.translatedText) {\n        // Save the translated text\n        setVietnameseSummary(data.translatedText);\n        return data.translatedText;\n      } else {\n        throw new Error('Translation failed');\n      }\n    } catch (error) {\n      console.error('Error translating to Vietnamese:', error);\n      return 'Không thể dịch nội dung này sang tiếng Việt. Vui lòng thử lại sau.';\n    }\n  };\n\n  const addModelOutput = (output: string) => {\n    setModelOutput(prev => [...prev, output]);\n  };\n\n  const value: AssistantContextType = {\n    currentInterface,\n    setCurrentInterface,\n    transcripts,\n    setTranscripts,\n    addTranscript,\n    orderSummary,\n    setOrderSummary,\n    callDetails,\n    setCallDetails,\n    order,\n    setOrder,\n    callDuration,\n    setCallDuration,\n    isMuted,\n    toggleMute,\n    startCall,\n    endCall,\n    callSummary,\n    setCallSummary,\n    serviceRequests,\n    setServiceRequests,\n    vietnameseSummary,\n    setVietnameseSummary,\n    translateToVietnamese,\n    emailSentForCurrentSession,\n    setEmailSentForCurrentSession,\n    requestReceivedAt,\n    setRequestReceivedAt,\n    activeOrders,\n    addActiveOrder,\n    micLevel,\n    modelOutput,\n    setModelOutput,\n    addModelOutput,\n    language,\n    setLanguage,\n  };\n\n  return (\n    <AssistantContext.Provider value={value}>\n      {children}\n    </AssistantContext.Provider>\n  );\n}\n\nexport function useAssistant() {\n  const context = useContext(AssistantContext);\n  if (context === undefined) {\n    throw new Error('useAssistant must be used within an AssistantProvider');\n  }\n  return context;\n}","import en from './en.json';\nimport fr from './fr.json';\nimport zh from './zh.json';\nimport ru from './ru.json';\nimport ko from './ko.json';\n\nexport type Lang = 'en' | 'fr' | 'zh' | 'ru' | 'ko';\n\nconst resources = { en, fr, zh, ru, ko };\n\nexport function t(key: string, lang: Lang = 'en'): string {\n  return (resources[lang] as Record<string, string>)[key] || key;\n} ","import React, { memo, useMemo } from 'react';\nimport { t } from '../i18n';\nimport { useAssistant } from '../context/AssistantContext';\nimport { Language } from '@/types';\n\ninterface InfographicStepsProps {\n  currentStep?: number;\n  compact?: boolean;\n  horizontal?: boolean;\n  language?: Language;\n}\n\ninterface StepProps {\n  step: {\n    icon: string;\n    title: string;\n    desc: string;\n  };\n  index: number;\n  currentStep: number;\n  compact?: boolean;\n  horizontal?: boolean;\n}\n\nconst Step = memo(({ step, index, currentStep, compact, horizontal }: StepProps) => {\n  const isActive = index + 1 === currentStep;\n  const isCompleted = index + 1 < currentStep;\n  \n  const iconStyle = useMemo(() => ({\n    width: horizontal ? 22 : (compact ? 32 : 48),\n    height: horizontal ? 22 : (compact ? 32 : 48),\n    fontSize: horizontal ? 13 : (compact ? 18 : 28),\n  }), [horizontal, compact]);\n  \n  const iconClasses = useMemo(() => `\n    flex items-center justify-center rounded-full shadow-lg transition-all duration-300\n    ${isActive \n      ? 'bg-[#d4af37] text-blue-900 border-2 border-[#d4af37]' \n      : 'bg-white/30 text-white border border-gray-200'\n    }\n  `, [isActive]);\n  \n  const titleClasses = useMemo(() => `\n    font-semibold font-poppins mb-1\n    ${horizontal ? 'text-[10px]' : (compact ? 'text-xs' : 'text-base')}\n    ${isActive ? 'text-white' : 'text-white/70'}\n  `, [horizontal, compact, isActive]);\n  \n  const descClasses = useMemo(() => `\n    font-light\n    ${horizontal ? 'text-[8px]' : (compact ? 'text-[10px]' : 'text-sm')}\n    text-white/80\n    ${horizontal ? 'hidden md:block' : ''}\n  `, [horizontal, compact]);\n  \n  const containerClasses = useMemo(() => `\n    flex flex-col items-center transition-all duration-300\n    ${isActive ? 'opacity-100 scale-105' : isCompleted ? 'opacity-60' : 'opacity-40'}\n    ${horizontal ? 'w-auto' : 'w-full'}\n  `, [isActive, isCompleted, horizontal]);\n  \n  return (\n    <div className={containerClasses}>\n      <div className={iconClasses} style={iconStyle}>\n        <span className=\"material-icons\" aria-hidden=\"true\">{step.icon}</span>\n      </div>\n      <div className=\"text-center\">\n        <div className={titleClasses}>{step.title}</div>\n        <div className={descClasses}>{step.desc}</div>\n      </div>\n    </div>\n  );\n});\n\nconst InfographicSteps = memo(({ currentStep = 1, compact = false, horizontal = false, language: propLanguage }: InfographicStepsProps) => {\n  const { language: contextLanguage } = useAssistant ? useAssistant() : { language: 'en' };\n  const language: Language = (propLanguage || contextLanguage || 'en') as Language;\n\n  const steps = useMemo(() => [\n    {\n      icon: 'call',\n      title: t('press_to_call', language),\n      desc: t('press_to_call_desc', language),\n    },\n    {\n      icon: 'check_circle',\n      title: t('confirm_request', language),\n      desc: t('confirm_request_desc', language),\n    },\n    {\n      icon: 'mail',\n      title: t('send_to_reception', language),\n      desc: t('send_to_reception_desc', language),\n    },\n  ], [language]);\n\n  if (horizontal) {\n    return (\n      <div \n        className=\"flex flex-row items-center justify-center w-full gap-2 md:gap-6 py-1\"\n        role=\"list\"\n        aria-label={t('process_steps', language as Language)}\n      >\n        {steps.map((step, idx) => (\n          <React.Fragment key={step.title}>\n            <div role=\"listitem\" aria-current={idx + 1 === currentStep ? 'step' : undefined}>\n              <Step\n                step={step}\n                index={idx}\n                currentStep={currentStep}\n                horizontal={horizontal}\n              />\n            </div>\n            {idx < steps.length - 1 && (\n              <div \n                className=\"h-0.5 w-3 md:w-8 bg-gradient-to-r from-[#d4af37]/80 to-transparent mx-1 rounded-full\"\n                aria-hidden=\"true\"\n              />\n            )}\n          </React.Fragment>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className={`w-full ${compact ? 'max-w-[160px] py-2 gap-3' : 'max-w-xs py-6 gap-6'} mx-auto flex flex-col items-center`}\n      role=\"list\"\n      aria-label={t('process_steps', language as Language)}\n    >\n      {steps.map((step, idx) => (\n        <div key={step.title} role=\"listitem\" aria-current={idx + 1 === currentStep ? 'step' : undefined}>\n          <Step\n            step={step}\n            index={idx}\n            currentStep={currentStep}\n            compact={compact}\n          />\n          {idx < steps.length - 1 && (\n            <div \n              className={`mx-auto my-1 rounded-full ${compact ? 'w-0.5 h-4' : 'w-1 h-8'} bg-gradient-to-b from-[#d4af37]/80 to-transparent`}\n              aria-hidden=\"true\"\n            />\n          )}\n        </div>\n      ))}\n    </div>\n  );\n});\n\nexport default InfographicSteps; ","import { useState, useEffect, useCallback, useRef } from 'react';\nimport { useAssistant } from '@/context/AssistantContext';\n\nexport function useWebSocket() {\n  const [socket, setSocket] = useState<WebSocket | null>(null);\n  const [connected, setConnected] = useState(false);\n  const { callDetails, addTranscript } = useAssistant();\n  const retryRef = useRef(0);\n\n  // Initialize WebSocket connection\n  const initWebSocket = useCallback(() => {\n    console.log('useWebSocket env VITE_API_HOST:', import.meta.env.VITE_API_HOST);\n    if (socket !== null) {\n      socket.close();\n    }\n\n    // Always connect WebSocket to the current application origin\n    const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n    const wsUrl = `${protocol}//${window.location.host}/ws`;\n    console.log('Attempting WebSocket connection to', wsUrl);\n    \n    const newSocket = new WebSocket(wsUrl);\n    \n    newSocket.onopen = () => {\n      console.log('WebSocket connection established');\n      setConnected(true);\n      retryRef.current = 0; // reset retry count\n      \n      // Send initial message with call ID if available\n      if (callDetails) {\n        newSocket.send(JSON.stringify({\n          type: 'init',\n          callId: callDetails.id\n        }));\n      }\n    };\n    \n    newSocket.onmessage = (event) => {\n      try {\n        const data = JSON.parse(event.data);\n        \n        // Handle transcript messages\n        if (data.type === 'transcript') {\n          addTranscript({\n            callId: data.callId,\n            role: data.role,\n            content: data.content\n          });\n        }\n      } catch (error) {\n        console.error('Error parsing WebSocket message:', error);\n      }\n    };\n    \n    newSocket.onclose = (event) => {\n      console.log('WebSocket connection closed', event);\n      setConnected(false);\n      \n      // Reconnect with exponential backoff\n      if (retryRef.current < 5) {\n        const delay = Math.pow(2, retryRef.current) * 1000;\n        console.log(`Reconnecting WebSocket in ${delay}ms (attempt ${retryRef.current + 1})`);\n        setTimeout(initWebSocket, delay);\n        retryRef.current++;\n      } else {\n        console.warn('Max WebSocket reconnection attempts reached');\n      }\n    };\n    \n    newSocket.onerror = (event) => {\n      console.error('WebSocket encountered error', event);\n      // Close socket to trigger reconnect logic\n      if (newSocket.readyState !== WebSocket.CLOSED) {\n        newSocket.close();\n      }\n    };\n    \n    setSocket(newSocket);\n    \n    return () => {\n      newSocket.close();\n    };\n  }, [callDetails, addTranscript]);\n\n  // Send message through WebSocket\n  const sendMessage = useCallback((message: any) => {\n    if (socket && connected) {\n      socket.send(JSON.stringify(message));\n    } else {\n      console.error('Cannot send message, WebSocket not connected');\n    }\n  }, [socket, connected]);\n\n  // Reconnect function\n  const reconnect = useCallback(() => {\n    if (!connected) {\n      initWebSocket();\n    }\n  }, [connected, initWebSocket]);\n\n  // Initialize WebSocket on mount\n  useEffect(() => {\n    initWebSocket();\n    \n    return () => {\n      if (socket) {\n        socket.close();\n      }\n    };\n  }, []);\n\n  // Re-send init if callDetails.id becomes available after socket is open\n  useEffect(() => {\n    if (socket && connected && callDetails?.id) {\n      console.log('Sending init message with callId after availability', callDetails.id);\n      socket.send(JSON.stringify({\n        type: 'init',\n        callId: callDetails.id\n      }));\n    }\n  }, [callDetails?.id, socket, connected]);\n\n  return { connected, sendMessage, reconnect };\n}\n","import React, { useState, useEffect } from 'react';\nimport { cn } from '@/lib/utils';\n\ninterface ImageProps extends React.ImgHTMLAttributes<HTMLImageElement> {\n  src: string;\n  alt: string;\n  className?: string;\n  fallbackSrc?: string;\n  loading?: 'lazy' | 'eager';\n  width?: number;\n  height?: number;\n}\n\nexport const Image: React.FC<ImageProps> = ({\n  src,\n  alt,\n  className,\n  fallbackSrc = '/placeholder.webp',\n  loading = 'lazy',\n  width,\n  height,\n  ...props\n}) => {\n  const [imgSrc, setImgSrc] = useState<string>(src);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(false);\n\n  useEffect(() => {\n    setImgSrc(src);\n    setIsLoading(true);\n    setError(false);\n  }, [src]);\n\n  const handleError = () => {\n    if (!error) {\n      setError(true);\n      setImgSrc(fallbackSrc);\n    }\n  };\n\n  return (\n    <div className={cn('relative overflow-hidden', className)}>\n      {isLoading && (\n        <div className=\"absolute inset-0 bg-gray-200 animate-pulse\" />\n      )}\n      <img\n        src={imgSrc}\n        alt={alt}\n        loading={loading}\n        width={width}\n        height={height}\n        onLoad={() => setIsLoading(false)}\n        onError={handleError}\n        className={cn(\n          'transition-opacity duration-300',\n          isLoading ? 'opacity-0' : 'opacity-100',\n          className\n        )}\n        {...props}\n      />\n    </div>\n  );\n}; ","import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","import React, { useEffect, useState } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from './ui/dialog';\nimport { Button } from './ui/button';\nimport InfographicSteps from './InfographicSteps';\nimport { useAssistant } from '@/context/AssistantContext';\nimport { t } from '@/i18n';\nimport { FaPhoneAlt, FaQuestionCircle, FaCheckCircle, FaPaperPlane } from 'react-icons/fa';\n\nconst BLUE_LAGOON_COLORS = {\n  primary: '#79DBDC',\n  secondary: '#79DCDC',\n  accent: '#559A9A',\n  light: '#E2FFFF',\n  lighter: '#C6FFFF',\n};\n\nconst OnboardingModal: React.FC = () => {\n  const assistantContext = useAssistant();\n  const language = (assistantContext as any)?.language || 'en';\n  const [open, setOpen] = useState(false);\n\n  useEffect(() => {\n    const hasSeenOnboarding = localStorage.getItem('hasSeenOnboarding');\n    if (!hasSeenOnboarding) {\n      setOpen(true);\n    }\n  }, []);\n\n  const handleClose = () => {\n    setOpen(false);\n    localStorage.setItem('hasSeenOnboarding', 'true');\n  };\n\n  const handleShowGuide = () => setOpen(true);\n\n  return (\n    <>\n      <button\n        onClick={handleShowGuide}\n        className=\"fixed top-4 right-4 z-[60] bg-white/90 hover:bg-[#E2FFFF] text-[#559A9A] rounded-full shadow-lg p-2 transition-colors\"\n        aria-label=\"Show Guide\"\n        style={{ fontSize: 28 }}\n      >\n        <FaQuestionCircle />\n      </button>\n      <Dialog open={open} onOpenChange={setOpen}>\n        {open ? <div className=\"fixed inset-0 z-40 bg-[#559A9A]/40\" /> : null}\n        <DialogContent\n          className=\"sm:max-w-md z-50 rounded-2xl shadow-2xl border-0 p-0 min-h-[480px] max-h-[90vh] overflow-y-auto\"\n          style={{ background: `linear-gradient(135deg, ${BLUE_LAGOON_COLORS.light} 60%, ${BLUE_LAGOON_COLORS.lighter})` }}\n        >\n          <DialogHeader className=\"items-center text-center\">\n            <DialogTitle className=\"text-2xl font-bold text-[#559A9A] mb-1\">\n              {t('onboarding_title', language)}\n            </DialogTitle>\n            <DialogDescription className=\"text-base text-[#559A9A] mb-2\">\n              {t('onboarding_description', language)}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"flex flex-col items-center py-6 gap-6 w-full\">\n            {/* Step 1 */}\n            <div className=\"flex flex-col items-center w-full px-4 py-2 bg-white/80 rounded-xl shadow border border-[#E2FFFF]\">\n              <div className=\"rounded-full bg-[#79DBDC] shadow-lg flex items-center justify-center mb-2\" style={{ width: 56, height: 56 }}>\n                <FaPhoneAlt size={28} color=\"#fff\" />\n              </div>\n              <span className=\"text-[#559A9A] font-semibold text-base text-center\">{t('onboarding_step1', language)}</span>\n            </div>\n            {/* Step 2 */}\n            <div className=\"flex flex-col items-center w-full px-4 py-2 bg-white/80 rounded-xl shadow border border-[#E2FFFF]\">\n              <div className=\"rounded-full bg-[#79DCDC] shadow-lg flex items-center justify-center mb-2\" style={{ width: 56, height: 56 }}>\n                <FaCheckCircle size={28} color=\"#fff\" />\n              </div>\n              <span className=\"text-[#559A9A] font-semibold text-base text-center\">{t('onboarding_step2', language)}</span>\n            </div>\n            {/* Step 3 */}\n            <div className=\"flex flex-col items-center w-full px-4 py-2 bg-white/80 rounded-xl shadow border border-[#E2FFFF]\">\n              <div className=\"rounded-full bg-[#C6FFFF] shadow-lg flex items-center justify-center mb-2\" style={{ width: 56, height: 56 }}>\n                <FaPaperPlane size={28} color=\"#559A9A\" />\n              </div>\n              <span className=\"text-[#559A9A] font-semibold text-base text-center\">{t('onboarding_step3', language)}</span>\n            </div>\n          </div>\n          <DialogFooter className=\"flex justify-end\">\n            <Button\n              onClick={handleClose}\n              className=\"px-6 py-2 text-base font-semibold rounded-lg shadow-md\"\n              style={{ background: BLUE_LAGOON_COLORS.primary, color: '#fff' }}\n            >\n              {t('start_using', language)}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n};\n\nexport default OnboardingModal; ","import React, { useEffect, useState } from 'react';\n\nconst CHECK_INTERVAL = 60000; // 60s\n\nconst VersionChecker: React.FC = () => {\n  const [show, setShow] = useState(false);\n  const [latest, setLatest] = useState<string | null>(null);\n\n  useEffect(() => {\n    let currentVersion: string | null = null;\n    const fetchVersion = async () => {\n      try {\n        const res = await fetch('/version.txt', { cache: 'no-store' });\n        const text = await res.text();\n        if (!currentVersion) {\n          currentVersion = text.trim();\n        } else if (text.trim() !== currentVersion) {\n          setLatest(text.trim());\n          setShow(true);\n        }\n      } catch {}\n    };\n    fetchVersion();\n    const interval = setInterval(fetchVersion, CHECK_INTERVAL);\n    return () => clearInterval(interval);\n  }, []);\n\n  if (!show) return null;\n  return (\n    <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/40\">\n      <div className=\"bg-white rounded-xl shadow-2xl p-6 max-w-xs text-center\">\n        <div className=\"text-lg font-semibold mb-2 text-[#559A9A]\">A new update is available!</div>\n        <div className=\"mb-4 text-gray-600\">Please refresh the page to get the latest version.</div>\n        <button\n          className=\"px-4 py-2 rounded-lg bg-[#79DBDC] text-white font-bold shadow\"\n          onClick={() => window.location.reload()}\n        >\n          Refresh Now\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default VersionChecker; ","import React, { useEffect, lazy, memo, Suspense } from 'react';\nimport { useAssistant } from '@/context/AssistantContext';\nimport { Link } from 'wouter';\nimport { History } from 'lucide-react';\nimport InfographicSteps from './InfographicSteps';\nimport { useWebSocket } from '@/hooks/useWebSocket';\nimport { Image } from './ui/Image';\nimport ErrorBoundary from './ErrorBoundary';\nimport { Language, InterfaceLayer } from '@/types';\nimport OnboardingModal from './OnboardingModal';\nimport VersionChecker from './VersionChecker';\n\n// Lazy load interfaces\nconst Interface1 = lazy(() => import('./Interface1'));\nconst Interface2 = lazy(() => import('./Interface2'));\nconst Interface3 = lazy(() => import('./Interface3'));\nconst Interface3Vi = lazy(() => import('./Interface3Vi'));\nconst Interface3Fr = lazy(() => import('./Interface3Fr'));\nconst Interface4 = lazy(() => import('./Interface4'));\n\n// Loading component\nconst LoadingFallback = memo(() => (\n  <div className=\"w-full h-full flex items-center justify-center\">\n    <div className=\"text-center\">\n      <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n      <p className=\"text-lg text-gray-400\">Đang tải giao diện...</p>\n    </div>\n  </div>\n));\n\n// Header component\nconst Header = memo(({ currentInterface, language }: { currentInterface: InterfaceLayer; language: Language }) => (\n  <header className=\"w-full bg-primary text-white p-4 shadow-md\">\n    <div className=\"container mx-auto flex items-center justify-between px-2\">\n      <div className=\"w-16 flex-shrink-0 flex items-center justify-start ml-1 sm:ml-4 mr-2 sm:mr-6\">\n        <Image \n          src=\"/assets/references/images/minhon-logo.jpg\" \n          alt=\"Minhon Logo\" \n          className=\"h-10 sm:h-14 w-auto rounded-lg shadow-md bg-white/80 p-1\"\n          loading=\"eager\"\n        />\n      </div>\n      <div className=\"flex-1 flex justify-center\">\n        <div className=\"w-full max-w-xs sm:max-w-md\">\n          <InfographicSteps \n            horizontal \n            compact \n            currentStep={\n              currentInterface === 'interface3' ? 3 :\n              currentInterface === 'interface2' ? 2 : 1\n            }\n            language={language}\n          />\n        </div>\n      </div>\n      <div className=\"w-10 flex-shrink-0 flex items-center justify-end ml-2 sm:ml-6 mr-1 sm:mr-2\">\n        <Link href=\"/call-history\">\n          <a \n            className=\"flex items-center gap-1 px-2 py-1 rounded bg-primary-dark text-white text-xs sm:text-sm hover:bg-primary-darker transition-colors\"\n            aria-label=\"View Call History\"\n          >\n            <History className=\"w-4 h-4\" aria-hidden=\"true\" />\n            <span className=\"hidden sm:inline\">Call History</span>\n          </a>\n        </Link>\n      </div>\n    </div>\n  </header>\n));\n\n// Interface container component\nconst InterfaceContainer = memo(({ currentInterface }: { currentInterface: InterfaceLayer }) => (\n  <div className=\"relative w-full h-full\" id=\"interfaceContainer\">\n    <ErrorBoundary>\n      <Suspense fallback={<LoadingFallback />}>\n        <Interface1 isActive={currentInterface === 'interface1'} />\n        <Interface2 isActive={currentInterface === 'interface2'} />\n        <Interface3 isActive={currentInterface === 'interface3'} />\n        <Interface3Vi isActive={currentInterface === 'interface3vi'} />\n        <Interface3Fr isActive={currentInterface === 'interface3fr'} />\n        <Interface4 isActive={currentInterface === 'interface4'} />\n      </Suspense>\n    </ErrorBoundary>\n  </div>\n));\n\nconst VoiceAssistant: React.FC = () => {\n  const assistantContext = useAssistant();\n  const currentInterface = (assistantContext as any)?.currentInterface || 'interface1';\n  const language = (assistantContext as any)?.language || 'en';\n  \n  // Initialize WebSocket connection\n  useWebSocket();\n\n  return (\n    <div \n      className=\"relative h-screen overflow-hidden font-sans text-gray-800 bg-neutral-50\" \n      id=\"app\"\n      role=\"application\"\n      aria-label=\"Voice Assistant\"\n    >\n      <VersionChecker />\n      <OnboardingModal />\n      <Header currentInterface={currentInterface} language={language} />\n      <InterfaceContainer currentInterface={currentInterface} />\n    </div>\n  );\n};\n\nexport default memo(VoiceAssistant);\n","import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","import React, { useState } from 'react';\n\nconst EmailTester: React.FC = () => {\n  const [sending, setSending] = useState(false);\n  const [result, setResult] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [email, setEmail] = useState('tuans2@gmail.com');\n\n  const sendTestEmail = async () => {\n    try {\n      setSending(true);\n      setResult(null);\n      setError(null);\n\n      console.log('Sending test email to:', email);\n      \n      // Get device info\n      const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);\n      console.log('Device type:', isMobile ? 'mobile' : 'desktop');\n      \n      // First try the regular endpoint\n      try {\n        const response = await fetch('/api/test-email', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            toEmail: email,\n            isMobile: isMobile\n          }),\n          cache: 'no-cache',\n        });\n        \n        const data = await response.json();\n        \n        if (data.success) {\n          setResult(`Email sent successfully using standard method! Provider: ${data.provider || 'unknown'}`);\n          setSending(false);\n          return;\n        } else {\n          console.warn('Standard method failed, trying mobile-specific endpoint');\n        }\n      } catch (err) {\n        console.error('Error with standard endpoint:', err);\n      }\n      \n      // Luôn thử cả phương thức tiêu chuẩn và phương thức dành cho thiết bị di động\n      try {\n        console.log('Thử sử dụng endpoint dành riêng cho di động...');\n        // Mở rộng phát hiện thiết bị di động\n        const isMobile = /iPhone|iPad|iPod|Android|Mobile|webOS|BlackBerry/i.test(navigator.userAgent);\n        \n        // Thêm timestamp để ngăn cache\n        const timestamp = new Date().getTime();\n        const mobileResponse = await fetch(`/api/mobile-test-email?_=${timestamp}`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'X-Device-Type': isMobile ? 'mobile' : 'desktop',\n            'Cache-Control': 'no-cache, no-store, must-revalidate',\n            'Pragma': 'no-cache',\n            'Expires': '0'\n          },\n          body: JSON.stringify({\n            toEmail: email,\n            timestamp: timestamp,\n            deviceInfo: navigator.userAgent\n          }),\n          cache: 'no-cache',\n          credentials: 'same-origin',\n          keepalive: true // Duy trì kết nối ngay cả khi chuyển trang\n        });\n        \n        const mobileData = await mobileResponse.json();\n        \n        if (mobileData.success) {\n          setResult(`Email đang được xử lý qua endpoint tối ưu hóa cho ${isMobile ? 'di động' : 'desktop'}! Vui lòng kiểm tra hộp thư sau vài giây.`);\n          \n          // Gửi thông báo đến console để kiểm tra\n          console.log(`Đã gửi yêu cầu thành công đến ${isMobile ? 'mobile' : 'desktop'} endpoint.`);\n          console.log('Response:', mobileData);\n        } else {\n          throw new Error(mobileData.error || 'Lỗi không xác định với endpoint di động');\n        }\n      } catch (mobileErr: any) {\n        console.error('Chi tiết lỗi mobile endpoint:', mobileErr);\n        setError(`Không thể gửi email: ${mobileErr?.message || 'Lỗi không xác định'}`);\n      }\n      \n      setSending(false);\n    } catch (err: any) {\n      console.error('Error sending test email:', err);\n      setError(`Error: ${err?.message || 'Unknown error'}`);\n      setSending(false);\n    }\n  };\n\n  return (\n    <div className=\"p-4 border rounded-lg shadow-md bg-white max-w-md mx-auto mt-4\">\n      <h2 className=\"text-xl font-bold mb-4 text-primary\">Kiểm tra Email trên Di động</h2>\n      \n      <div className=\"mb-4\">\n        <label className=\"block text-sm font-medium mb-1\">Email người nhận:</label>\n        <input\n          type=\"email\"\n          value={email}\n          onChange={(e) => setEmail(e.target.value)}\n          className=\"w-full p-2 border rounded focus:ring-2 focus:ring-primary\"\n          placeholder=\"example@gmail.com\"\n        />\n      </div>\n\n      <button\n        onClick={sendTestEmail}\n        disabled={sending}\n        className={`w-full p-3 rounded font-medium text-white ${\n          sending ? 'bg-gray-400' : 'bg-primary hover:bg-primary/90'\n        }`}\n      >\n        {sending ? 'Đang gửi...' : 'Gửi Email Kiểm tra'}\n      </button>\n\n      {result && (\n        <div className=\"mt-4 p-3 bg-green-100 text-green-800 rounded\">\n          {result}\n        </div>\n      )}\n\n      {error && (\n        <div className=\"mt-4 p-3 bg-red-100 text-red-800 rounded\">\n          {error}\n        </div>\n      )}\n      \n      <div className=\"mt-4 text-sm text-gray-500\">\n        <p>\n          * Công cụ này giúp kiểm tra việc gửi email trên thiết bị di động.\n          Nếu phương thức tiêu chuẩn không hoạt động, hệ thống sẽ tự động thử\n          phương thức tối ưu hóa cho di động.\n        </p>\n      </div>\n    </div>\n  );\n};\n\nexport default EmailTester;","import React, { useState } from 'react';\n\ninterface StaffLoginProps {\n  onLogin: () => void;\n}\n\nconst StaffLogin: React.FC<StaffLoginProps> = ({ onLogin }) => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!username || !password) {\n      setError('Please enter both username and password.');\n      return;\n    }\n    setError('');\n    try {\n      const res = await fetch('/api/staff/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password })\n      });\n      if (!res.ok) {\n        const data = await res.json();\n        setError(data.error || 'Login failed.');\n        return;\n      }\n      const data = await res.json();\n      if (data.token) {\n        localStorage.setItem('staff_token', data.token);\n        onLogin();\n      } else {\n        setError('Login failed: No token received.');\n      }\n    } catch (err) {\n      setError('Login failed: Network or server error.');\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 to-blue-300\">\n      <form onSubmit={handleSubmit} className=\"bg-white p-8 rounded-xl shadow-lg w-full max-w-md space-y-6 border border-gray-200\">\n        <h2 className=\"text-2xl font-bold text-blue-900 mb-4 text-center\">Staff Login</h2>\n        {error && <div className=\"text-red-500 text-sm mb-2\">{error}</div>}\n        <div>\n          <label className=\"block text-gray-700 font-medium mb-1\">Username</label>\n          <input type=\"text\" className=\"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400\" value={username} onChange={e => setUsername(e.target.value)} autoFocus />\n        </div>\n        <div>\n          <label className=\"block text-gray-700 font-medium mb-1\">Password</label>\n          <input type=\"password\" className=\"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400\" value={password} onChange={e => setPassword(e.target.value)} />\n        </div>\n        <button type=\"submit\" className=\"w-full bg-blue-700 hover:bg-blue-800 text-white font-semibold py-2 rounded-lg transition\">Login</button>\n      </form>\n    </div>\n  );\n};\n\nexport default StaffLogin; ","import React, { useState } from 'react';\n\ninterface StaffRequestDetailModalProps {\n  request: any;\n  onClose: () => void;\n  onStatusChange: (status: string) => void;\n  onOpenMessage: () => void;\n}\n\nconst statusOptions = [\n  'Đã ghi nhận',\n  'Đang thực hiện',\n  'Đã thực hiện và đang bàn giao cho khách',\n  'Hoàn thiện',\n  'Lưu ý khác',\n];\n\nconst StaffRequestDetailModal: React.FC<StaffRequestDetailModalProps> = ({ request, onClose, onStatusChange, onOpenMessage }) => {\n  const [pendingStatus, setPendingStatus] = useState<string>(request.status);\n  if (!request) return null;\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40\">\n      <div className=\"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg relative\">\n        <button className=\"absolute top-2 right-2 text-gray-500 hover:text-blue-700\" onClick={onClose}>&times;</button>\n        <h3 className=\"text-xl font-bold text-blue-900 mb-4\">Request Details</h3>\n        <div className=\"space-y-2 mb-4\">\n          <div><b>Room:</b> {request.room}</div>\n          <div><b>Order ID:</b> {request.id}</div>\n          <div><b>Guest Name:</b> {request.guestName}</div>\n          <div><b>Content:</b> {request.content}</div>\n          <div><b>Time:</b> {request.time}</div>\n          <div className=\"flex items-center gap-2\">\n            <b>Status:</b>\n            <select className=\"border rounded px-2 py-1 text-xs\" value={pendingStatus} onChange={e => setPendingStatus(e.target.value)}>\n              {statusOptions.map(opt => (\n                <option key={opt} value={opt}>{opt}</option>\n              ))}\n            </select>\n          </div>\n          <div><b>Notes:</b> {request.notes || '-'}</div>\n        </div>\n        <div className=\"flex gap-2 justify-end\">\n          <button className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded font-semibold\" onClick={() => { if (pendingStatus !== request.status) onStatusChange(pendingStatus); }}>Cập Nhật</button>\n          <button className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded font-semibold\" onClick={onOpenMessage}>Nhắn khách</button>\n          <button className=\"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded font-semibold\" onClick={onClose}>Đóng</button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default StaffRequestDetailModal; ","import React, { useState } from 'react';\n\ninterface Message {\n  id: string;\n  sender: string;\n  content: string;\n  time: string;\n}\n\ninterface StaffMessagePopupProps {\n  messages: Message[];\n  onSend: (msg: string) => void;\n  onClose: () => void;\n  loading?: boolean;\n}\n\nconst StaffMessagePopup: React.FC<StaffMessagePopupProps> = ({ messages, onSend, onClose, loading }) => {\n  const [input, setInput] = useState('');\n\n  const handleSend = () => {\n    if (input.trim()) {\n      onSend(input);\n      setInput('');\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40\">\n      <div className=\"bg-white rounded-xl shadow-xl p-5 w-full max-w-md relative flex flex-col\">\n        <button className=\"absolute top-2 right-2 text-gray-500 hover:text-blue-700\" onClick={onClose}>&times;</button>\n        <h3 className=\"text-lg font-bold text-blue-900 mb-3\">Nhắn tin tới Guest</h3>\n        <div className=\"flex-1 overflow-y-auto mb-3 max-h-60 border rounded p-2 bg-gray-50\">\n          {messages.length === 0 ? (\n            <div className=\"text-gray-400 text-sm text-center\">Chưa có tin nhắn</div>\n          ) : (\n            messages.map(msg => (\n              <div key={msg.id} className={`mb-2 ${msg.sender === 'staff' ? 'text-right' : 'text-left'}`}>\n                <div className={`inline-block px-3 py-1 rounded-lg ${msg.sender === 'staff' ? 'bg-blue-100 text-blue-900' : 'bg-gray-200 text-gray-800'}`}>\n                  <span className=\"font-semibold\">{msg.sender === 'staff' ? 'Staff' : 'Guest'}:</span> {msg.content}\n                </div>\n                <div className=\"text-xs text-gray-400 mt-0.5\">{msg.time}</div>\n              </div>\n            ))\n          )}\n        </div>\n        <div className=\"flex gap-2 mt-2\">\n          <input\n            type=\"text\"\n            className=\"flex-1 border rounded px-2 py-1\"\n            placeholder=\"Nhập tin nhắn...\"\n            value={input}\n            onChange={e => setInput(e.target.value)}\n            onKeyDown={e => { if (e.key === 'Enter') handleSend(); }}\n            disabled={loading}\n          />\n          <button\n            className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-1 rounded font-semibold\"\n            onClick={handleSend}\n            disabled={loading || !input.trim()}\n          >Gửi</button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default StaffMessagePopup; ","import React, { useState, useEffect, Suspense } from 'react';\nimport StaffRequestDetailModal from '../components/StaffRequestDetailModal';\nimport StaffMessagePopup from '../components/StaffMessagePopup';\nimport { useNavigate } from 'react-router-dom';\n\nconst statusOptions = [\n  'Tất cả',\n  'Đã ghi nhận',\n  'Đang thực hiện',\n  'Đã thực hiện và đang bàn giao cho khách',\n  'Hoàn thiện',\n  'Lưu ý khác',\n];\n\nconst statusColor = (status: string) => {\n  switch (status) {\n    case 'Đã ghi nhận': return 'bg-gray-300 text-gray-800';\n    case 'Đang thực hiện': return 'bg-yellow-200 text-yellow-800';\n    case 'Đã thực hiện và đang bàn giao cho khách': return 'bg-blue-200 text-blue-800';\n    case 'Hoàn thiện': return 'bg-green-200 text-green-800';\n    case 'Lưu ý khác': return 'bg-red-200 text-red-800';\n    default: return 'bg-gray-100 text-gray-700';\n  }\n};\n\nconst StaffRequestTable = React.lazy(() => import('../components/StaffRequestTable'));\n\nconst StaffDashboard: React.FC = () => {\n  const [requests, setRequests] = useState<any[]>([]);\n  const [selectedRequest, setSelectedRequest] = useState<any>(null);\n  const [showDetailModal, setShowDetailModal] = useState(false);\n  const [showMessagePopup, setShowMessagePopup] = useState(false);\n  const [messages, setMessages] = useState<any[]>([]);\n  const [loadingMsg, setLoadingMsg] = useState(false);\n  const [statusFilter, setStatusFilter] = useState('Tất cả');\n  const [startDate, setStartDate] = useState('');\n  const [endDate, setEndDate] = useState('');\n  const [expandedContent, setExpandedContent] = useState<number | null>(null);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [showPasswordDialog, setShowPasswordDialog] = useState(false);\n  const [deletePassword, setDeletePassword] = useState('');\n  const [passwordError, setPasswordError] = useState('');\n  const [pendingStatus, setPendingStatus] = useState<{ [id: number]: string }>({});\n  const navigate = useNavigate();\n\n  // Lấy token từ localStorage\n  const getToken = () => localStorage.getItem('staff_token');\n\n  // Fetch requests from API\n  const fetchRequests = async () => {\n    const token = getToken();\n    if (!token) {\n      navigate('/staff');\n      return;\n    }\n    try {\n      const res = await fetch('/api/staff/requests', {\n        headers: { 'Authorization': `Bearer ${token}` },\n        credentials: 'include'\n      });\n      if (res.status === 401) {\n        localStorage.removeItem('staff_token');\n        navigate('/staff');\n        return;\n      }\n      const data = await res.json();\n      console.log('Fetched requests data:', data); // Debug log\n      setRequests(data);\n    } catch (err) {\n      console.error('Failed to fetch requests:', err);\n    }\n  };\n\n  useEffect(() => {\n    fetchRequests();\n    // Thêm polling mỗi 30 giây\n    const intervalId = setInterval(fetchRequests, 30000);\n    return () => clearInterval(intervalId);\n  }, []);\n\n  // Mở modal chi tiết\n  const handleOpenDetail = (req: any) => {\n    setSelectedRequest(req);\n    setShowDetailModal(true);\n  };\n  // Đóng modal chi tiết\n  const handleCloseDetail = () => {\n    setShowDetailModal(false);\n    setSelectedRequest(null);\n  };\n  // Cập nhật trạng thái request\n  const handleStatusChange = async (status: string, reqId: number) => {\n    const token = getToken();\n    if (!token) return navigate('/staff');\n    try {\n      await fetch(`/api/staff/requests/${reqId}/status`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        credentials: 'include',\n        body: JSON.stringify({ status })\n      });\n      // Cập nhật local state ngay\n      setRequests(reqs => reqs.map(r => r.id === reqId ? { ...r, status } : r));\n      if (selectedRequest && selectedRequest.id === reqId) setSelectedRequest({ ...selectedRequest, status });\n    } catch (err) {\n      console.error('Failed to update status:', err);\n    }\n  };\n  // Mở popup nhắn tin\n  const handleOpenMessage = async () => {\n    setShowMessagePopup(true);\n    if (!selectedRequest) return;\n    const token = getToken();\n    if (!token) return navigate('/staff');\n    try {\n      const res = await fetch(`/api/staff/requests/${selectedRequest.id}/messages`, {\n        headers: { 'Authorization': `Bearer ${token}` },\n        credentials: 'include'\n      });\n      const data = await res.json();\n      setMessages(data);\n    } catch (err) {\n      setMessages([]);\n    }\n  };\n  // Đóng popup nhắn tin\n  const handleCloseMessage = () => setShowMessagePopup(false);\n  // Gửi tin nhắn\n  const handleSendMessage = async (msg: string) => {\n    setLoadingMsg(true);\n    const token = getToken();\n    if (!token) return navigate('/staff');\n    try {\n      await fetch(`/api/staff/requests/${selectedRequest.id}/message`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        credentials: 'include',\n        body: JSON.stringify({ content: msg })\n      });\n      setMessages(msgs => [\n        ...msgs,\n        { id: (msgs.length + 1).toString(), sender: 'staff', content: msg, time: new Date().toLocaleTimeString().slice(0,5) }\n      ]);\n    } catch (err) {\n      // handle error\n    }\n    setLoadingMsg(false);\n  };\n\n  // Xóa tất cả requests\n  const handleDeleteAllRequests = async () => {\n    setShowPasswordDialog(true);\n    setDeletePassword('');\n    setPasswordError('');\n  };\n\n  // Xác nhận xóa sau khi nhập mật khẩu\n  const confirmDelete = async () => {\n    // Kiểm tra mật khẩu\n    if (deletePassword !== '2208') {\n      setPasswordError('Mật khẩu không đúng');\n      return;\n    }\n    \n    setIsDeleting(true);\n    \n    try {\n      const token = getToken();\n      if (!token) {\n        setShowPasswordDialog(false);\n        return navigate('/staff');\n      }\n      \n      const response = await fetch('/api/staff/requests/all', {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        credentials: 'include'\n      });\n      \n      const result = await response.json();\n      \n      setShowPasswordDialog(false);\n      \n      if (result.success) {\n        alert(`${result.message}`);\n        // Cập nhật state để hiển thị danh sách trống\n        setRequests([]);\n      } else {\n        alert(`Lỗi: ${result.error || 'Không thể xóa requests'}`);\n      }\n    } catch (error) {\n      console.error('Error deleting all requests:', error);\n      alert('Đã xảy ra lỗi khi xóa requests');\n      setShowPasswordDialog(false);\n    } finally {\n      setIsDeleting(false);\n      setDeletePassword('');\n    }\n  };\n\n  // Filter requests theo status và thời gian\n  const filteredRequests = requests.filter(r => {\n    // Filter theo status\n    if (statusFilter !== 'Tất cả' && r.status !== statusFilter) {\n      return false;\n    }\n    \n    // Filter theo thời gian\n    if (startDate || endDate) {\n      const requestDate = new Date(r.created_at);\n      \n      if (startDate) {\n        const filterStartDate = new Date(startDate);\n        filterStartDate.setHours(0, 0, 0, 0);\n        if (requestDate < filterStartDate) return false;\n      }\n      \n      if (endDate) {\n        const filterEndDate = new Date(endDate);\n        filterEndDate.setHours(23, 59, 59, 999);\n        if (requestDate > filterEndDate) return false;\n      }\n    }\n    \n    return true;\n  });\n\n  // Xử lý khi nhấn Enter trong hộp mật khẩu\n  const handlePasswordKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Enter') {\n      confirmDelete();\n    }\n    // Xóa thông báo lỗi khi người dùng bắt đầu nhập lại\n    if (passwordError) {\n      setPasswordError('');\n    }\n  };\n\n  // Ngăn chặn việc đóng modal khi click bên ngoài\n  const handleDialogClick = (e: React.MouseEvent<HTMLDivElement>) => {\n    e.stopPropagation();\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-blue-200 p-2 sm:p-6\">\n      <div className=\"max-w-7xl mx-auto bg-white rounded-xl shadow-lg p-3 sm:p-6 border border-gray-200\">\n        {/* Logo và tiêu đề */}\n        <div className=\"flex flex-col items-center mb-6\">\n          <img \n            src=\"/assets/references/images/minhon-logo.jpg\" \n            alt=\"Minhon Logo\" \n            className=\"h-16 object-contain mb-2\"\n          />\n          <h2 className=\"text-xl sm:text-2xl font-bold text-blue-900 text-center\">Staff Request Management</h2>\n        </div>\n\n        {/* Nút Refresh */}\n        <div className=\"flex justify-between mb-4\">\n          <button\n            onClick={handleDeleteAllRequests}\n            disabled={isDeleting || requests.length === 0}\n            className={`w-auto bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded font-semibold ${(isDeleting || requests.length === 0) ? 'opacity-50 cursor-not-allowed' : ''}`}\n          >\n            {isDeleting ? 'Đang xóa...' : 'Xóa tất cả Requests'}\n          </button>\n          <button\n            onClick={fetchRequests}\n            className=\"w-auto bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded font-semibold\"\n          >\n            Refresh\n          </button>\n        </div>\n\n        {/* Filters */}\n        <div className=\"mb-4 grid grid-cols-1 gap-4\">\n          {/* Filter status */}\n          <div className=\"flex flex-wrap items-center gap-2 sm:gap-3\">\n            <label className=\"font-semibold text-blue-900 w-full sm:w-auto\">Lọc theo trạng thái:</label>\n            <select\n              className=\"w-full sm:w-auto border rounded px-3 py-1 text-sm\"\n              value={statusFilter}\n              onChange={e => setStatusFilter(e.target.value)}\n            >\n              {statusOptions.map(opt => (\n                <option key={opt} value={opt}>{opt}</option>\n              ))}\n            </select>\n          </div>\n          \n          {/* Filter thời gian */}\n          <div className=\"flex flex-wrap items-center gap-2 sm:gap-3\">\n            <label className=\"font-semibold text-blue-900 w-full sm:w-auto\">Lọc theo thời gian:</label>\n            <div className=\"flex flex-col sm:flex-row items-start sm:items-center gap-2 w-full sm:w-auto\">\n              <div className=\"flex items-center gap-2 w-full sm:w-auto\">\n                <label className=\"text-sm text-gray-600 min-w-10\">Từ:</label>\n                <input \n                  type=\"date\" \n                  className=\"border rounded px-2 py-1 text-sm w-full\"\n                  value={startDate}\n                  onChange={e => setStartDate(e.target.value)}\n                />\n              </div>\n              <div className=\"flex items-center gap-2 w-full sm:w-auto\">\n                <label className=\"text-sm text-gray-600 min-w-10\">Đến:</label>\n                <input \n                  type=\"date\" \n                  className=\"border rounded px-2 py-1 text-sm w-full\"\n                  value={endDate}\n                  onChange={e => setEndDate(e.target.value)}\n                />\n              </div>\n              {(startDate || endDate) && (\n                <button\n                  onClick={() => {\n                    setStartDate('');\n                    setEndDate('');\n                  }}\n                  className=\"text-blue-600 hover:text-blue-800 text-sm mt-2 sm:mt-0\"\n                >\n                  Xóa lọc\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Mobile version of requests - Card style */}\n        <div className=\"block sm:hidden\">\n          <div className=\"space-y-4\">\n            {/* Debug log */}\n            {(() => { console.log('Mobile rendering - filteredRequests:', filteredRequests); return null; })()}\n            {filteredRequests.length > 0 ? (\n              [...filteredRequests]\n                .sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime())\n                .map(req => (\n                  <div key={req.id} className=\"border rounded-lg p-3 bg-white shadow-sm\">\n                    <div className=\"flex justify-between mb-2\">\n                      <div className=\"font-semibold\">Phòng: {req.room_number || 'N/A'}</div>\n                      <div className={`px-2 py-1 rounded-full text-xs font-semibold ${statusColor(req.status)}`}>{req.status || 'Chưa xác định'}</div>\n                    </div>\n                    <div className=\"text-sm text-gray-500 mb-2\">Order ID: {req.orderId || req.id || 'N/A'}</div>\n                    <div className=\"text-xs text-gray-500 mb-3\">\n                      {req.created_at ? (\n                        <>\n                          {new Date(req.created_at).toLocaleDateString()} {new Date(req.created_at).toLocaleTimeString()}\n                        </>\n                      ) : (\n                        'Thời gian không xác định'\n                      )}\n                    </div>\n\n                    {/* Collapsible content */}\n                    <div className=\"mb-3\">\n                      <button \n                        onClick={() => setExpandedContent(expandedContent === req.id ? null : req.id)}\n                        className=\"w-full flex justify-between items-center py-1 px-2 border rounded bg-gray-50 hover:bg-gray-100\"\n                      >\n                        <span className=\"text-sm font-medium text-blue-700\">\n                          {expandedContent === req.id ? 'Ẩn nội dung' : 'Xem nội dung'}\n                        </span>\n                        <svg \n                          className={`w-4 h-4 text-blue-700 transition-transform ${expandedContent === req.id ? 'rotate-180' : ''}`} \n                          fill=\"none\" \n                          stroke=\"currentColor\" \n                          viewBox=\"0 0 24 24\"\n                        >\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 9l-7 7-7-7\" />\n                        </svg>\n                      </button>\n                      \n                      {expandedContent === req.id && (\n                        <div className=\"mt-2 p-2 bg-gray-50 rounded-md whitespace-pre-line break-words text-sm\">\n                          {req.request_content || 'Không có nội dung'}\n                        </div>\n                      )}\n                    </div>\n\n                    <div className=\"flex flex-col gap-2\">\n                      <select\n                        className=\"border rounded px-2 py-2 text-sm w-full\"\n                        value={pendingStatus[req.id] ?? req.status}\n                        onChange={e => setPendingStatus(s => ({ ...s, [req.id]: e.target.value }))}\n                      >\n                        {statusOptions.filter(opt => opt !== 'Tất cả').map(opt => (\n                          <option key={opt} value={opt}>{opt}</option>\n                        ))}\n                      </select>\n                      <div className=\"grid grid-cols-2 gap-2\">\n                        <button\n                          className=\"bg-blue-600 hover:bg-blue-700 text-white px-2 py-2 rounded text-sm font-semibold\"\n                          onClick={async () => {\n                            const newStatus = pendingStatus[req.id];\n                            if (newStatus && newStatus !== req.status) {\n                              await handleStatusChange(newStatus, req.id);\n                              setPendingStatus(s => {\n                                const { [req.id]: _, ...rest } = s;\n                                return rest;\n                              });\n                            }\n                          }}\n                        >Cập Nhật</button>\n                        <button className=\"bg-green-600 hover:bg-green-700 text-white px-2 py-2 rounded text-sm font-semibold\" onClick={() => { setSelectedRequest(req); handleOpenMessage(); }}>Nhắn khách</button>\n                      </div>\n                    </div>\n                  </div>\n                ))\n            ) : (\n              <div className=\"text-center py-8 text-gray-500\">\n                <p>Không có yêu cầu nào</p>\n                <p className=\"mt-2 text-sm\">Nhấn Refresh để tải lại dữ liệu</p>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Desktop version - Table */}\n        <Suspense fallback={<div className=\"hidden sm:block text-center py-8 text-gray-500\">Đang tải bảng...</div>}>\n          <StaffRequestTable\n            filteredRequests={filteredRequests}\n            pendingStatus={pendingStatus}\n            setPendingStatus={setPendingStatus}\n            statusOptions={statusOptions}\n            handleStatusChange={handleStatusChange}\n            setSelectedRequest={setSelectedRequest}\n            handleOpenMessage={handleOpenMessage}\n            statusColor={statusColor}\n          />\n        </Suspense>\n      </div>\n      {/* Modal chi tiết request */}\n      {showDetailModal && selectedRequest && (\n        <StaffRequestDetailModal\n          request={selectedRequest}\n          onClose={handleCloseDetail}\n          onStatusChange={status => handleStatusChange(status, selectedRequest.id)}\n          onOpenMessage={handleOpenMessage}\n        />\n      )}\n      {/* Popup nhắn tin */}\n      {showMessagePopup && selectedRequest && (\n        <StaffMessagePopup\n          messages={messages}\n          onClose={handleCloseMessage}\n          onSend={handleSendMessage}\n          loading={loadingMsg}\n        />\n      )}\n      {/* Password Dialog for Delete */}\n      {showPasswordDialog && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white p-6 rounded-lg shadow-lg w-full max-w-md mx-4\" onClick={handleDialogClick}>\n            <h3 className=\"text-lg font-bold text-red-600 mb-4\">Xác nhận xóa toàn bộ requests</h3>\n            <p className=\"mb-4 text-gray-700\">Hành động này sẽ xóa tất cả requests và không thể hoàn tác. Vui lòng nhập mật khẩu để xác nhận:</p>\n            \n            <div className=\"mb-4\">\n              <input\n                type=\"password\"\n                value={deletePassword}\n                onChange={(e) => setDeletePassword(e.target.value)}\n                onKeyDown={handlePasswordKeyDown}\n                className={`w-full px-3 py-2 border rounded ${passwordError ? 'border-red-500' : 'border-gray-300'} focus:outline-none focus:ring-2 focus:ring-red-500`}\n                placeholder=\"Nhập mật khẩu xác nhận\"\n                autoFocus\n              />\n              {passwordError && <p className=\"text-red-500 text-sm mt-1\">{passwordError}</p>}\n              <p className=\"text-gray-500 text-xs mt-2 italic\">Biện pháp bảo vệ: Chức năng xóa yêu cầu mật khẩu xác nhận để ngăn ngừa xóa dữ liệu do nhầm lẫn.</p>\n            </div>\n            \n            <div className=\"flex justify-end space-x-3\">\n              <button\n                onClick={() => setShowPasswordDialog(false)}\n                className=\"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded transition duration-200\"\n              >\n                Hủy\n              </button>\n              <button\n                onClick={confirmDelete}\n                disabled={isDeleting}\n                className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded transition duration-200 flex items-center disabled:opacity-70\"\n              >\n                {isDeleting ? (\n                  <>\n                    <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                      <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                      <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                    </svg>\n                    Đang xóa...\n                  </>\n                ) : (\n                  <>\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                    </svg>\n                    Xác nhận xóa\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default StaffDashboard; ","import React, { useState } from 'react';\nimport StaffLogin from './StaffLogin';\nimport StaffDashboard from './StaffDashboard';\n\nconst StaffPage: React.FC = () => {\n  // State giả lập đăng nhập\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n\n  // Xử lý đăng nhập thành công\n  const handleLoginSuccess = () => setIsLoggedIn(true);\n\n  return isLoggedIn ? <StaffDashboard /> : <StaffLogin onLogin={handleLoginSuccess} />;\n};\n\nexport default StaffPage; ","import React, { Suspense } from \"react\";\nimport ErrorBoundary from '@/components/ErrorBoundary';\nimport { Switch, Route, Link } from \"wouter\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport VoiceAssistant from \"@/components/VoiceAssistant\";\nimport { AssistantProvider } from \"@/context/AssistantContext\";\nimport NotFound from \"@/pages/not-found\";\nimport EmailTester from \"@/components/EmailTester\";\nimport { useWebSocket } from '@/hooks/useWebSocket';\nimport StaffPage from '@/pages/staff';\nimport { BrowserRouter } from 'react-router-dom';\n\n// Lazy-loaded components\nconst CallHistory = React.lazy(() => import('@/pages/CallHistory'));\nconst CallDetails = React.lazy(() => import('@/pages/CallDetails'));\n\n// Loading fallback\nconst LoadingFallback = () => (\n  <div className=\"flex items-center justify-center h-screen bg-gray-50\">\n    <div className=\"flex flex-col items-center\">\n      <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4\"></div>\n      <p className=\"text-gray-500\">Đang tải...</p>\n    </div>\n  </div>\n);\n\n// Email tester page\nconst EmailTestPage = () => {\n  return (\n    <div className=\"min-h-screen bg-gray-50 py-8\">\n      <div className=\"container mx-auto\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h1 className=\"text-2xl font-bold text-gray-800\">Kiểm tra Tính năng Email</h1>\n          <Link href=\"/\" className=\"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90\">\n            Quay lại Trang Chính\n          </Link>\n        </div>\n        <EmailTester />\n      </div>\n    </div>\n  );\n};\n\nfunction Router() {\n  return (\n    <Suspense fallback={<LoadingFallback />}>\n      <Switch>\n        <Route path=\"/call-history\" component={CallHistory} />\n        <Route path=\"/call-details/:callId\" component={CallDetails} />\n        <Route path=\"/email-test\" component={EmailTestPage} />\n        <Route path=\"/staff\" component={StaffPage} />\n        <Route path=\"/\" component={VoiceAssistant} />\n        <Route component={NotFound} />\n      </Switch>\n    </Suspense>\n  );\n}\n\nfunction App() {\n  // Initialize WebSocket globally to keep connection across routes\n  useWebSocket();\n  return (\n    <BrowserRouter>\n      <AssistantProvider>\n        <ErrorBoundary>\n          <Router />\n          <Toaster />\n        </ErrorBoundary>\n      </AssistantProvider>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest({\n  url,\n  method = 'GET',\n  body = undefined,\n}: {\n  url: string;\n  method?: string;\n  body?: unknown;\n}): Promise<any> {\n  const res = await fetch(url, {\n    method,\n    headers: body ? { \"Content-Type\": \"application/json\" } : {},\n    body: body ? JSON.stringify(body) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  try {\n    return await res.json();\n  } catch (e) {\n    return res;\n  }\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey[0] as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { AssistantProvider } from \"./context/AssistantContext\";\n\ncreateRoot(document.getElementById(\"root\")!).render(\n  <QueryClientProvider client={queryClient}>\n    <AssistantProvider>\n      <App />\n    </AssistantProvider>\n  </QueryClientProvider>\n);\n"],"file":"assets/index-B87HseW6.js"}