const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Interface1-DvttRbJG.js","assets/react-BlJs-Rj_.js","assets/@daily-co-CRt2XSsO.js","assets/react-icons-du4cCclG.js","assets/react-dom-qFx4IFJ8.js","assets/scheduler-DYLXRpC5.js","assets/wouter-DSgBA37d.js","assets/regexparam-CPXopyEH.js","assets/use-sync-external-store-T8uco2Ip.js","assets/@radix-ui-QlMI2MB_.js","assets/react-remove-scroll-BI7w_Xav.js","assets/tslib-CDuPK5Eb.js","assets/react-remove-scroll-bar-BrVopqW4.js","assets/react-style-singleton-QOKzqUsk.js","assets/get-nonce-C-Z93AgS.js","assets/use-sidecar-1JKJ7J1d.js","assets/use-callback-ref-5JKzev4p.js","assets/aria-hidden-DQ5UC2Eg.js","assets/class-variance-authority-Dp3B9jqt.js","assets/clsx-B-dksMZM.js","assets/tailwind-merge-D696Ktp4.js","assets/lucide-react-CxnTV3od.js","assets/@vapi-ai-DrvmIiYL.js","assets/events-CXH2uRM3.js","assets/react-router-DvHbwIsR.js","assets/@remix-run-DBo92Irb.js","assets/react-router-dom-BMXKYxTf.js","assets/@tanstack-H40tjzcj.js","assets/Interface2-c2s3JLeu.js","assets/swiper-CfFrfE8b.js","assets/swiper-B_l4pjL9.css","assets/Interface3-BcwZLjSP.js","assets/Interface3Vi-fkj_qHBx.js","assets/Interface3Fr-CSF8biqW.js","assets/Interface4-jMep-S7x.js","assets/StaffRequestTable-DHRf05Hf.js","assets/CallHistory-CIRaBg0a.js","assets/CallDetails-CHM_Q-IP.js"])))=>i.map(i=>d[i]);
import{r as o,j as e,R as q}from"./react-BlJs-Rj_.js";import{R as pe,c as Qe}from"./react-dom-qFx4IFJ8.js";import{L as ve,S as Ye,R as F}from"./wouter-DSgBA37d.js";import{V as ye,R as $e,A as we,C as je,T as Ne,D as Se,P as Ze,O as Ce,a as et,b as ke,c as tt,d as Ae,e as Ee,f as nt,S as st}from"./@radix-ui-QlMI2MB_.js";import{c as Te}from"./class-variance-authority-Dp3B9jqt.js";import{c as ot}from"./clsx-B-dksMZM.js";import{t as rt}from"./tailwind-merge-D696Ktp4.js";import{X as Re,H as at,C as it}from"./lucide-react-CxnTV3od.js";import{_ as ct}from"./@vapi-ai-DrvmIiYL.js";import{F as lt,a as dt,b as ut,c as mt}from"./react-icons-du4cCclG.js";import{u as _t}from"./react-router-DvHbwIsR.js";import{B as gt}from"./react-router-dom-BMXKYxTf.js";import{Q as pt,a as ft}from"./@tanstack-H40tjzcj.js";import"./@daily-co-CRt2XSsO.js";import"./scheduler-DYLXRpC5.js";import"./regexparam-CPXopyEH.js";import"./use-sync-external-store-T8uco2Ip.js";import"./react-remove-scroll-BI7w_Xav.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-BrVopqW4.js";import"./react-style-singleton-QOKzqUsk.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-1JKJ7J1d.js";import"./use-callback-ref-5JKzev4p.js";import"./aria-hidden-DQ5UC2Eg.js";import"./events-CXH2uRM3.js";import"./@remix-run-DBo92Irb.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function s(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(a){if(a.ep)return;a.ep=!0;const l=s(a);fetch(a.href,l)}})();const ht="modulepreload",xt=function(t){return"/"+t},fe={},A=function(n,s,c){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),i=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));a=Promise.allSettled(s.map(_=>{if(_=xt(_),_ in fe)return;fe[_]=!0;const p=_.endsWith(".css"),h=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${h}`))return;const g=document.createElement("link");if(g.rel=p?"stylesheet":ht,p||(g.as="script"),g.crossOrigin="",g.href=_,i&&g.setAttribute("nonce",i),document.head.appendChild(g),p)return new Promise((v,b)=>{g.addEventListener("load",v),g.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(d){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=d,window.dispatchEvent(i),!i.defaultPrevented)throw d}return a.then(d=>{for(const i of d||[])i.status==="rejected"&&l(i.reason);return n().catch(l)})};class De extends o.Component{constructor(n){super(n),this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,s){console.error("Uncaught error in component tree:",n,s)}render(){return this.state.hasError?e.jsx("div",{className:"flex items-center justify-center h-screen p-4 bg-gray-50",children:e.jsxs("div",{className:"max-w-md text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-2",children:"Something went wrong."}),e.jsx("p",{className:"text-gray-700 mb-4",children:"An unexpected error occurred. Please try refreshing the page or contact support if the problem persists."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Reload Page"})]})}):this.props.children}}const bt=1,vt=1e6;let le=0;function yt(){return le=(le+1)%Number.MAX_SAFE_INTEGER,le.toString()}const de=new Map,he=t=>{if(de.has(t))return;const n=setTimeout(()=>{de.delete(t),G({type:"REMOVE_TOAST",toastId:t})},vt);de.set(t,n)},$t=(t,n)=>{switch(n.type){case"ADD_TOAST":return{...t,toasts:[n.toast,...t.toasts].slice(0,bt)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(s=>s.id===n.toast.id?{...s,...n.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=n;return s?he(s):t.toasts.forEach(c=>{he(c.id)}),{...t,toasts:t.toasts.map(c=>c.id===s||s===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return n.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(s=>s.id!==n.toastId)}}},te=[];let ne={toasts:[]};function G(t){ne=$t(ne,t),te.forEach(n=>{n(ne)})}function wt({...t}){const n=yt(),s=a=>G({type:"UPDATE_TOAST",toast:{...a,id:n}}),c=()=>G({type:"DISMISS_TOAST",toastId:n});return G({type:"ADD_TOAST",toast:{...t,id:n,open:!0,onOpenChange:a=>{a||c()}}}),{id:n,dismiss:c,update:s}}function jt(){const[t,n]=o.useState(ne);return o.useEffect(()=>(te.push(n),()=>{const s=te.indexOf(n);s>-1&&te.splice(s,1)}),[t]),{...t,toast:wt,dismiss:s=>G({type:"DISMISS_TOAST",toastId:s})}}function $(...t){return rt(ot(t))}const Nt=Ze,Oe=o.forwardRef(({className:t,...n},s)=>e.jsx(ye,{ref:s,className:$("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...n}));Oe.displayName=ye.displayName;const St=Te("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-dark",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ie=o.forwardRef(({className:t,variant:n,...s},c)=>e.jsx($e,{ref:c,className:$(St({variant:n}),t),...s}));Ie.displayName=$e.displayName;const Ct=o.forwardRef(({className:t,...n},s)=>e.jsx(we,{ref:s,className:$("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...n}));Ct.displayName=we.displayName;const Me=o.forwardRef(({className:t,...n},s)=>e.jsx(je,{ref:s,className:$("absolute right-2 top-2 rounded-md p-1 text-dark/50 opacity-0 transition-opacity hover:text-dark focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...n,children:e.jsx(Re,{className:"h-4 w-4"})}));Me.displayName=je.displayName;const Pe=o.forwardRef(({className:t,...n},s)=>e.jsx(Ne,{ref:s,className:$("text-sm font-semibold",t),...n}));Pe.displayName=Ne.displayName;const Le=o.forwardRef(({className:t,...n},s)=>e.jsx(Se,{ref:s,className:$("text-sm opacity-90",t),...n}));Le.displayName=Se.displayName;function kt(){const{toasts:t}=jt();return e.jsxs(Nt,{children:[t.map(function({id:n,title:s,description:c,action:a,...l}){return e.jsxs(Ie,{...l,children:[e.jsxs("div",{className:"grid gap-1",children:[s&&e.jsx(Pe,{children:s}),c&&e.jsx(Le,{children:c})]}),a,e.jsx(Me,{})]},n)}),e.jsx(Oe,{})]})}const At=!1;let N=null;const Et=async t=>{try{return N||(N=new ct(t),N.on("call-start",()=>{console.log("Call started")}),N.on("call-end",()=>{console.log("Call ended")}),N.on("speech-start",()=>{console.log("Speech started")}),N.on("speech-end",()=>{console.log("Speech ended")}),N.on("volume-level",n=>{console.log(`Volume level: ${n}`)}),N.on("message",n=>{console.log("Message received:",n)}),N.on("error",n=>{console.error("Error:",n)}),N)}catch(n){throw console.error("Failed to initialize Vapi:",n),n}},ee=()=>N,Tt={orderType:"Room Service",deliveryTime:"asap",roomNumber:"",guestName:"",guestEmail:"",guestPhone:"",specialInstructions:"",items:[{id:"1",name:"Club Sandwich",description:"Served with french fries and side salad",quantity:1,price:15},{id:"2",name:"Fresh Orange Juice",description:"Large size",quantity:1,price:8}],totalAmount:23},Fe=o.createContext(void 0);function qe({children:t}){const[n,s]=o.useState("interface1"),[c,a]=o.useState([]),[l,d]=o.useState(null),[i,_]=o.useState(null),[p,h]=o.useState(null),[g,v]=o.useState(0),[b,y]=o.useState(null),[P,R]=o.useState(!1),[X,S]=o.useState(null),[se,k]=o.useState([]),[Q,Y]=o.useState(null),[D,V]=o.useState(!1),[z,L]=o.useState(null),[O,B]=o.useState(()=>{if(typeof window>"u")return[];try{const r=localStorage.getItem("activeOrders");return r?JSON.parse(r).map(m=>({...m,requestedAt:new Date(m.requestedAt)})):[]}catch(r){return console.error("Failed to parse activeOrders from localStorage",r),[]}}),[H,E]=o.useState(0),[I,M]=o.useState([]),[j,W]=o.useState("en");o.useEffect(()=>{if(!(typeof window>"u"))try{localStorage.setItem("activeOrders",JSON.stringify(O))}catch{console.error("Failed to persist activeOrders to localStorage")}},[O]);const U=r=>{B(u=>[...u,{...r,status:r.status||"Đã ghi nhận"}])},oe=q.useCallback(r=>{const u={...r,id:Date.now(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,timestamp:new Date};a(m=>[...m,u])},[i==null?void 0:i.id]);o.useEffect(()=>((async()=>{try{throw new Error("Vapi public key is not configured")}catch(u){console.error("Error setting up Vapi:",u)}})(),()=>{const u=ee();u&&u.stop()}),[]),o.useEffect(()=>{if(n==="interface2"){console.log("Starting call duration timer in interface2");const r=setInterval(()=>{v(u=>{const m=u+1;return console.log("Call duration updated:",m),m})},1e3);y(r)}else b&&(console.log("Clearing call duration timer when leaving interface2"),clearInterval(b),y(null));return()=>{b&&(console.log("Cleaning up call duration timer"),clearInterval(b))}},[n,b]);const re=()=>{const r=ee();r&&(r.setMuted(!P),R(!P))},ae=q.useCallback(async()=>{try{V(!1);const r=`call-${Date.now()}`;_({id:r,roomNumber:"",duration:"0",category:""}),a([]),M([]);const u=ee();if(!u){console.error("Vapi instance not initialized");return}const m=void 0;if(!m){console.error("Assistant ID not configured");return}if(!await u.start(m)){console.error("Failed to start call - call object is null");return}console.log("Call started successfully"),v(0);const f=setInterval(()=>{v(x=>x+1)},1e3);y(f),s("interface2")}catch(r){console.error("Error starting call:",r)}},[]),Z=o.useCallback(()=>{try{const r=ee();r&&r.stop();const u=()=>{b&&(clearInterval(b),y(null)),d(Tt);const m=g?`${Math.floor(g/60)}:${(g%60).toString().padStart(2,"0")}`:"0:00",C=c.map(x=>({role:x.role,content:x.content}));if(C.length<2){const x={id:Date.now(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,content:"Call was too short to generate a summary. Please try a more detailed conversation.",timestamp:new Date};S(x),s("interface3");return}const f={id:Date.now(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,content:"Generating AI summary of your conversation...",timestamp:new Date};S(f),fetch("/api/store-summary",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({summary:"",transcripts:C,timestamp:new Date().toISOString(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,callDuration:m,forceBasicSummary:At,language:j})}).then(x=>{if(!x.ok)throw new Error(`Network response was not ok: ${x.status}`);return x.json()}).then(x=>{if(x.success&&x.summary&&x.summary.content){const T=x.summary.content;pe.unstable_batchedUpdates(()=>{const ce={id:Date.now(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,content:T,timestamp:new Date(x.summary.timestamp||Date.now())};S(ce),x.serviceRequests&&Array.isArray(x.serviceRequests)&&x.serviceRequests.length>0&&k(x.serviceRequests),s("interface3")})}}).catch(x=>{console.error("Error processing summary:",x);const T={id:Date.now(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,content:"An error occurred while generating the call summary.",timestamp:new Date};S(T),s("interface3")})};pe.unstable_batchedUpdates(u)}catch(r){console.error("Error in endCall:",r),s("interface1")}},[b,g,c,i,S,s,k,j]),ie={currentInterface:n,setCurrentInterface:s,transcripts:c,setTranscripts:a,addTranscript:oe,orderSummary:l,setOrderSummary:d,callDetails:i,setCallDetails:_,order:p,setOrder:h,callDuration:g,setCallDuration:v,isMuted:P,toggleMute:re,startCall:ae,endCall:Z,callSummary:X,setCallSummary:S,serviceRequests:se,setServiceRequests:k,vietnameseSummary:Q,setVietnameseSummary:Y,translateToVietnamese:async r=>{try{console.log("Requesting Vietnamese translation for summary...");const u=await fetch("/api/translate-to-vietnamese",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:r})});if(!u.ok)throw new Error(`Network response was not ok: ${u.status}`);const m=await u.json();if(m.success&&m.translatedText)return Y(m.translatedText),m.translatedText;throw new Error("Translation failed")}catch(u){return console.error("Error translating to Vietnamese:",u),"Không thể dịch nội dung này sang tiếng Việt. Vui lòng thử lại sau."}},emailSentForCurrentSession:D,setEmailSentForCurrentSession:V,requestReceivedAt:z,setRequestReceivedAt:L,activeOrders:O,addActiveOrder:U,micLevel:H,modelOutput:I,setModelOutput:M,addModelOutput:r=>{M(u=>[...u,r])},language:j,setLanguage:W};return e.jsx(Fe.Provider,{value:ie,children:t})}function J(){const t=o.useContext(Fe);if(t===void 0)throw new Error("useAssistant must be used within an AssistantProvider");return t}const Rt="Mi Nhon Hotel Mui Ne",Dt="AI-powered Voice Assistant - Supporting All Your Needs",Ot="Press to Call",It="Room & Stay",Mt="Room Services",Pt="Bookings & Facilities",Lt="Tourism & Exploration",Ft="Support to book external services",qt="Order Ref",Vt="Requested At",zt="Estimated Completion",Bt="Time Remaining",Ht="Mute",Wt="Unmute",Ut="Confirm",Kt="Please speak to the assistant first.",Gt="Tap to speak",Jt="Order Summary",Xt="Send to Reception",Qt="Add Note",Yt="Room Number",Zt="Enter room number",en="Enter additional notes",tn="Summary",nn="Generated at",sn="Order Confirmed!",on="Your request has been confirmed and forwarded to our staff. They will process it right away.",rn="Order Reference",an="Estimated delivery time:",cn="Return to Home",ln="Language",dn="English",un="French",mn="Send",_n="Cancel",gn="Confirm your request",pn="Room",fn="Order ID",hn="Guest Name",xn="Content",bn="Time",vn="Status",yn="Action",$n="Message Guest",wn="Staff Request Management",jn="Login",Nn="Username",Sn="Password",Cn="Tap the call button to start your request.",kn="Review and confirm your request for accuracy.",An="Your request will be sent to the reception for processing.",En="Acknowledged",Tn="In Progress",Rn="Delivering to You",Dn="Completed",On="Special Note",In="Check-in/Check-out",Mn="Extended Stay Request",Pn="Room Information",Ln="Hotel Policies",Fn="Wi-Fi Services",qn="Room Service Food",Vn="Drinks & Bar Service",zn="Room Cleaning",Bn="Laundry Service",Hn="Wake-up Call",Wn="Additional Amenities",Un="Maintenance Request",Kn="Restaurant Reservation",Gn="Spa Services",Jn="Fitness Center",Xn="Swimming Pool",Qn="Car Rental",Yn="Medical Assistance",Zn="Customer Support",es="Local Attractions",ts="Local Restaurants",ns="Public Transportation",ss="Local Events",os="Shopping Areas",rs="Area Maps",as="Translation Services",is="Leave a Review",cs="Report an Issue",ls="Luggage Services",ds="Welcome to Voice Assistant",us="You can speak to the assistant to order services, ask for information, and more.",ms="Start Using",_s="Press to Call",gs="Confirm your request",ps="Send to Reception",fs={hotel_name:Rt,hotel_subtitle:Dt,press_to_call:Ot,room_and_stay:It,room_services:Mt,bookings_and_facilities:Pt,tourism_and_exploration:Lt,support_external_services:Ft,order_ref:qt,requested_at:Vt,estimated_completion:zt,time_remaining:Bt,mute:Ht,unmute:Wt,confirm:Ut,need_conversation:Kt,tap_to_speak:Gt,order_summary:Jt,send_to_reception:Xt,add_note:Qt,room_number:Yt,enter_room_number:Zt,enter_notes:en,summary:tn,generated_at:nn,order_confirmed:sn,order_confirmed_message:on,order_reference:rn,estimated_delivery_time:an,return_to_home:cn,language:ln,english:dn,french:un,send:mn,cancel:_n,confirm_request:gn,room:pn,order_id:fn,guest_name:hn,content:xn,time:bn,status:vn,action:yn,message_guest:$n,request_management:wn,login:jn,username:Nn,password:Sn,press_to_call_desc:Cn,confirm_request_desc:kn,send_to_reception_desc:An,status_acknowledged:En,status_in_progress:Tn,status_delivering:Rn,status_completed:Dn,status_note:On,icon_login:In,icon_hourglass_empty:Mn,icon_info:Pn,icon_policy:Ln,icon_wifi:Fn,icon_restaurant:qn,icon_local_bar:Vn,icon_cleaning_services:zn,icon_local_laundry_service:Bn,icon_alarm:Hn,icon_add_circle:Wn,icon_build:Un,icon_event_seat:Kn,icon_spa:Gn,icon_fitness_center:Jn,icon_pool:Xn,icon_directions_car:Qn,icon_medical_services:Yn,icon_support_agent:Zn,icon_location_on:es,icon_local_dining:ts,icon_directions_bus:ns,icon_event:ss,icon_shopping_bag:os,icon_map:rs,icon_translate:as,icon_rate_review:is,icon_report_problem:cs,icon_luggage:ls,onboarding_title:ds,onboarding_description:us,start_using:ms,onboarding_step1:_s,onboarding_step2:gs,onboarding_step3:ps},hs="Bienvenue à Mi Nhon Hotel",xs="Commencer",bs="Langue",vs="Anglais",ys="Français",$s="Envoyer",ws="Annuler",js="Confirmer la demande",Ns="Chambre",Ss="ID de commande",Cs="Nom du client",ks="Contenu",As="Heure",Es="Statut",Ts="Action",Rs="Message au client",Ds="Gestion des demandes du personnel",Os="Connexion",Is="Nom d'utilisateur",Ms="Mot de passe",Ps="Mi Nhon Hotel Mui Ne",Ls="Assistant Vocal IA - Soutien à tous vos besoins",Fs="Appuyez pour Appeler",qs="Chambre & Séjour",Vs="Services de Chambre",zs="Réservations & Installations",Bs="Tourisme & Exploration",Hs="Soutien pour réserver des services externes",Ws="Réf. Commande",Us="Demandé à",Ks="Fin Estimée",Gs="Temps Restant",Js="Muet",Xs="Activer le Son",Qs="Confirmer",Ys="Veuillez d'abord parler à l'assistant.",Zs="Appuyez pour parler",eo="Résumé de la Commande",to="Envoyer à la Réception",no="Ajouter une Note",so="Numéro de Chambre",oo="Entrez le numéro de chambre",ro="Entrez des notes supplémentaires",ao="Résumé",io="Généré à",co="Commande Confirmée !",lo="Votre demande a été confirmée et transmise à notre personnel. Ils la traiteront immédiatement.",uo="Référence de la Commande",mo="Temps de livraison estimé :",_o="Retour à l'Accueil",go="Appuyez sur le bouton d'appel pour commencer votre demande.",po="Vérifiez et confirmez votre demande pour plus de précision.",fo="Votre demande sera envoyée à la réception pour traitement.",ho="Reconnu",xo="En Cours",bo="Livraison en Cours",vo="Terminé",yo="Note Spéciale",$o="Check-in/Check-out",wo="Demande de Séjour Prolongé",jo="Informations sur la Chambre",No="Politiques de l'Hôtel",So="Services Wi-Fi",Co="Service de Restauration en Chambre",ko="Boissons & Service de Bar",Ao="Nettoyage de Chambre",Eo="Service de Blanchisserie",To="Réveil",Ro="Équipements Supplémentaires",Do="Demande de Maintenance",Oo="Réservation de Restaurant",Io="Services de Spa",Mo="Centre de Fitness",Po="Piscine",Lo="Location de Voiture",Fo="Assistance Médicale",qo="Support Client",Vo="Attractions Locales",zo="Restaurants Locaux",Bo="Transport Public",Ho="Événements Locaux",Wo="Zones de Shopping",Uo="Cartes de la Zone",Ko="Services de Traduction",Go="Laisser un Avis",Jo="Signaler un Problème",Xo="Services de Bagages",Qo="Bienvenue sur l'Assistant Vocal",Yo="Vous pouvez parler à l'assistant pour commander des services, demander des informations, et plus encore.",Zo="Commencer à Utiliser",er="Appuyez pour appeler",tr="Confirmez votre demande",nr="Envoyer à la réception",sr={welcome:hs,start:xs,language:bs,english:vs,french:ys,send:$s,cancel:ws,confirm_request:js,room:Ns,order_id:Ss,guest_name:Cs,content:ks,time:As,status:Es,action:Ts,message_guest:Rs,request_management:Ds,login:Os,username:Is,password:Ms,hotel_name:Ps,hotel_subtitle:Ls,press_to_call:Fs,room_and_stay:qs,room_services:Vs,bookings_and_facilities:zs,tourism_and_exploration:Bs,support_external_services:Hs,order_ref:Ws,requested_at:Us,estimated_completion:Ks,time_remaining:Gs,mute:Js,unmute:Xs,confirm:Qs,need_conversation:Ys,tap_to_speak:Zs,order_summary:eo,send_to_reception:to,add_note:no,room_number:so,enter_room_number:oo,enter_notes:ro,summary:ao,generated_at:io,order_confirmed:co,order_confirmed_message:lo,order_reference:uo,estimated_delivery_time:mo,return_to_home:_o,press_to_call_desc:go,confirm_request_desc:po,send_to_reception_desc:fo,status_acknowledged:ho,status_in_progress:xo,status_delivering:bo,status_completed:vo,status_note:yo,icon_login:$o,icon_hourglass_empty:wo,icon_info:jo,icon_policy:No,icon_wifi:So,icon_restaurant:Co,icon_local_bar:ko,icon_cleaning_services:Ao,icon_local_laundry_service:Eo,icon_alarm:To,icon_add_circle:Ro,icon_build:Do,icon_event_seat:Oo,icon_spa:Io,icon_fitness_center:Mo,icon_pool:Po,icon_directions_car:Lo,icon_medical_services:Fo,icon_support_agent:qo,icon_location_on:Vo,icon_local_dining:zo,icon_directions_bus:Bo,icon_event:Ho,icon_shopping_bag:Wo,icon_map:Uo,icon_translate:Ko,icon_rate_review:Go,icon_report_problem:Jo,icon_luggage:Xo,onboarding_title:Qo,onboarding_description:Yo,start_using:Zo,onboarding_step1:er,onboarding_step2:tr,onboarding_step3:nr},or="欢迎来到美农酒店 (Mi Nhon Hotel)",rr="开始",ar="语言",ir="英语",cr="法语",lr="发送",dr="取消",ur="确认请求",mr="房间",_r="订单编号",gr="客人姓名",pr="内容",fr="时间",hr="状态",xr="操作",br="给客人的消息",vr="员工请求管理",yr="登录",$r="用户名",wr="密码",jr="Mi Nhon Hotel Mui Ne",Nr="AI语音助手 - 满足您的所有需求",Sr="点击呼叫",Cr="房间与住宿",kr="房间服务",Ar="预订与设施",Er="旅游与探索",Tr="支持预订外部服务",Rr="订单参考",Dr="请求时间",Or="预计完成",Ir="剩余时间",Mr="静音",Pr="取消静音",Lr="确认",Fr="请先与助手交谈。",qr="点击说话",Vr="订单摘要",zr="发送至前台",Br="添加备注",Hr="房间号",Wr="输入房间号",Ur="输入额外备注",Kr="摘要",Gr="生成时间",Jr="订单已确认！",Xr="您的请求已确认并转发给我们的员工。他们将立即处理。",Qr="订单参考",Yr="预计送达时间：",Zr="返回首页",ea="点击呼叫按钮开始您的请求。",ta="检查并确认您的请求以确保准确性。",na="您的请求将发送至前台进行处理。",sa="已确认",oa="进行中",ra="正在送达",aa="已完成",ia="特别备注",ca="入住/退房",la="延长住宿请求",da="房间信息",ua="酒店政策",ma="Wi-Fi服务",_a="客房送餐",ga="饮品和酒吧服务",pa="房间清洁",fa="洗衣服务",ha="叫醒服务",xa="额外设施",ba="维护请求",va="餐厅预订",ya="水疗服务",$a="健身中心",wa="游泳池",ja="租车服务",Na="医疗协助",Sa="客户支持",Ca="当地景点",ka="当地餐厅",Aa="公共交通",Ea="当地活动",Ta="购物区",Ra="区域地图",Da="翻译服务",Oa="留下评价",Ia="报告问题",Ma="行李服务",Pa="欢迎使用语音助手",La="您可以通过语音助手订购服务、查询信息等。",Fa="开始使用",qa="点击呼叫",Va="确认您的请求",za="发送到前台",Ba={welcome:or,start:rr,language:ar,english:ir,french:cr,send:lr,cancel:dr,confirm_request:ur,room:mr,order_id:_r,guest_name:gr,content:pr,time:fr,status:hr,action:xr,message_guest:br,request_management:vr,login:yr,username:$r,password:wr,hotel_name:jr,hotel_subtitle:Nr,press_to_call:Sr,room_and_stay:Cr,room_services:kr,bookings_and_facilities:Ar,tourism_and_exploration:Er,support_external_services:Tr,order_ref:Rr,requested_at:Dr,estimated_completion:Or,time_remaining:Ir,mute:Mr,unmute:Pr,confirm:Lr,need_conversation:Fr,tap_to_speak:qr,order_summary:Vr,send_to_reception:zr,add_note:Br,room_number:Hr,enter_room_number:Wr,enter_notes:Ur,summary:Kr,generated_at:Gr,order_confirmed:Jr,order_confirmed_message:Xr,order_reference:Qr,estimated_delivery_time:Yr,return_to_home:Zr,press_to_call_desc:ea,confirm_request_desc:ta,send_to_reception_desc:na,status_acknowledged:sa,status_in_progress:oa,status_delivering:ra,status_completed:aa,status_note:ia,icon_login:ca,icon_hourglass_empty:la,icon_info:da,icon_policy:ua,icon_wifi:ma,icon_restaurant:_a,icon_local_bar:ga,icon_cleaning_services:pa,icon_local_laundry_service:fa,icon_alarm:ha,icon_add_circle:xa,icon_build:ba,icon_event_seat:va,icon_spa:ya,icon_fitness_center:$a,icon_pool:wa,icon_directions_car:ja,icon_medical_services:Na,icon_support_agent:Sa,icon_location_on:Ca,icon_local_dining:ka,icon_directions_bus:Aa,icon_event:Ea,icon_shopping_bag:Ta,icon_map:Ra,icon_translate:Da,icon_rate_review:Oa,icon_report_problem:Ia,icon_luggage:Ma,onboarding_title:Pa,onboarding_description:La,start_using:Fa,onboarding_step1:qa,onboarding_step2:Va,onboarding_step3:za},Ha="Добро пожаловать в отель Mi Nhon",Wa="Начать",Ua="Язык",Ka="Английский",Ga="Французский",Ja="Русский",Xa="Отправить",Qa="Отмена",Ya="Подтвердить запрос",Za="Номер",ei="ID заказа",ti="Имя гостя",ni="Содержание",si="Время",oi="Статус",ri="Действие",ai="Сообщение гостю",ii="Управление запросами персонала",ci="Вход",li="Имя пользователя",di="Пароль",ui="Отель Mi Nhon Mui Ne",mi="ИИ-ассистент - Поддержка всех ваших потребностей",_i="Нажмите для звонка",gi="Номер и проживание",pi="Услуги номера",fi="Бронирование и удобства",hi="Туризм и исследование",xi="Поддержка внешних услуг",bi="Ссылка на заказ",vi="Запрошено в",yi="Предполагаемое завершение",$i="Оставшееся время",wi="Без звука",ji="Включить звук",Ni="Подтвердить",Si="Пожалуйста, сначала поговорите с ассистентом.",Ci="Нажмите, чтобы говорить",ki="Сводка заказа",Ai="Отправить на ресепшен",Ei="Добавить заметку",Ti="Номер комнаты",Ri="Введите номер комнаты",Di="Введите дополнительные заметки",Oi="Сводка",Ii="Сгенерировано в",Mi="Заказ подтвержден!",Pi="Ваш запрос подтвержден и передан нашему персоналу. Они обработают его немедленно.",Li="Ссылка на заказ",Fi="Предполагаемое время доставки:",qi="Вернуться на главную",Vi="Нажмите кнопку вызова, чтобы начать ваш запрос.",zi="Проверьте и подтвердите ваш запрос для точности.",Bi="Ваш запрос будет отправлен на ресепшен для обработки.",Hi="Подтверждено",Wi="В процессе",Ui="Доставляется",Ki="Завершено",Gi="Особая заметка",Ji="Регистрация/Выселение",Xi="Запрос на продление проживания",Qi="Информация о номере",Yi="Правила отеля",Zi="Wi-Fi услуги",ec="Ресторанное обслуживание номеров",tc="Напитки и бар",nc="Уборка номера",sc="Услуги прачечной",oc="Услуга будильника",rc="Дополнительные удобства",ac="Запрос на техническое обслуживание",ic="Бронирование ресторана",cc="СПА услуги",lc="Фитнес-центр",dc="Бассейн",uc="Аренда автомобиля",mc="Медицинская помощь",_c="Поддержка клиентов",gc="Местные достопримечательности",pc="Местные рестораны",fc="Общественный транспорт",hc="Местные мероприятия",xc="Торговые зоны",bc="Карты местности",vc="Услуги перевода",yc="Оставить отзыв",$c="Сообщить о проблеме",wc="Услуги багажа",jc="Добро пожаловать в голосового помощника",Nc="Вы можете говорить с помощником, чтобы заказать услуги, получить информацию и многое другое.",Sc="Начать использование",Cc="Нажмите для звонка",kc="Подтвердите ваш запрос",Ac="Отправить на ресепшен",Ec={welcome:Ha,start:Wa,language:Ua,english:Ka,french:Ga,russian:Ja,send:Xa,cancel:Qa,confirm_request:Ya,room:Za,order_id:ei,guest_name:ti,content:ni,time:si,status:oi,action:ri,message_guest:ai,request_management:ii,login:ci,username:li,password:di,hotel_name:ui,hotel_subtitle:mi,press_to_call:_i,room_and_stay:gi,room_services:pi,bookings_and_facilities:fi,tourism_and_exploration:hi,support_external_services:xi,order_ref:bi,requested_at:vi,estimated_completion:yi,time_remaining:$i,mute:wi,unmute:ji,confirm:Ni,need_conversation:Si,tap_to_speak:Ci,order_summary:ki,send_to_reception:Ai,add_note:Ei,room_number:Ti,enter_room_number:Ri,enter_notes:Di,summary:Oi,generated_at:Ii,order_confirmed:Mi,order_confirmed_message:Pi,order_reference:Li,estimated_delivery_time:Fi,return_to_home:qi,press_to_call_desc:Vi,confirm_request_desc:zi,send_to_reception_desc:Bi,status_acknowledged:Hi,status_in_progress:Wi,status_delivering:Ui,status_completed:Ki,status_note:Gi,icon_login:Ji,icon_hourglass_empty:Xi,icon_info:Qi,icon_policy:Yi,icon_wifi:Zi,icon_restaurant:ec,icon_local_bar:tc,icon_cleaning_services:nc,icon_local_laundry_service:sc,icon_alarm:oc,icon_add_circle:rc,icon_build:ac,icon_event_seat:ic,icon_spa:cc,icon_fitness_center:lc,icon_pool:dc,icon_directions_car:uc,icon_medical_services:mc,icon_support_agent:_c,icon_location_on:gc,icon_local_dining:pc,icon_directions_bus:fc,icon_event:hc,icon_shopping_bag:xc,icon_map:bc,icon_translate:vc,icon_rate_review:yc,icon_report_problem:$c,icon_luggage:wc,onboarding_title:jc,onboarding_description:Nc,start_using:Sc,onboarding_step1:Cc,onboarding_step2:kc,onboarding_step3:Ac},Tc="미년 호텔에 오신 것을 환영합니다",Rc="시작",Dc="언어",Oc="영어",Ic="프랑스어",Mc="러시아어",Pc="한국어",Lc="보내기",Fc="취소",qc="요청 확인",Vc="객실",zc="주문 ID",Bc="투숙객 이름",Hc="내용",Wc="시간",Uc="상태",Kc="동작",Gc="게스트에게 메시지 보내기",Jc="직원 요청 관리",Xc="로그인",Qc="사용자 이름",Yc="비밀번호",Zc="Mi Nhon Hotel Mui Ne",el="AI 음성 비서 - 모든 요구 사항 지원",tl="호출하려면 누르세요",nl="객실 및 숙박",sl="객실 서비스",ol="예약 및 시설",rl="관광 및 탐험",al="외부 서비스 예약 지원",il="주문 참조",cl="요청 시간",ll="예상 완료",dl="남은 시간",ul="음소거",ml="음소거 해제",_l="확인",gl="먼저 비서와 대화해 주세요.",pl="말하려면 탭하세요",fl="주문 요약",hl="프론트 데스크로 보내기",xl="메모 추가",bl="객실 번호",vl="객실 번호 입력",yl="추가 메모 입력",$l="요약",wl="생성 시간",jl="주문 확인됨!",Nl="요청이 확인되어 직원에게 전달되었습니다. 즉시 처리할 것입니다.",Sl="주문 참조",Cl="예상 배달 시간:",kl="홈으로 돌아가기",Al="호출 버튼을 눌러 요청을 시작하세요.",El="정확성을 위해 요청을 검토하고 확인하세요.",Tl="요청이 프론트 데스크로 전송되어 처리됩니다.",Rl="확인됨",Dl="진행 중",Ol="배달 중",Il="완료됨",Ml="특별 참고 사항",Pl="체크인/체크아웃",Ll="연장 숙박 요청",Fl="객실 정보",ql="호텔 정책",Vl="Wi-Fi 서비스",zl="룸 서비스 음식",Bl="음료 및 바 서비스",Hl="객실 청소",Wl="세탁 서비스",Ul="모닝콜",Kl="추가 편의 시설",Gl="유지보수 요청",Jl="레스토랑 예약",Xl="스파 서비스",Ql="피트니스 센터",Yl="수영장",Zl="렌터카",ed="의료 지원",td="고객 지원",nd="현지 명소",sd="현지 레스토랑",od="대중 교통",rd="현지 이벤트",ad="쇼핑 지역",id="지역 지도",cd="번역 서비스",ld="리뷰 남기기",dd="문제 보고",ud="수하물 서비스",md="음성 비서에 오신 것을 환영합니다",_d="비서와 대화하여 서비스를 주문하고, 정보를 요청하는 등 다양한 작업을 수행할 수 있습니다.",gd="사용 시작",pd="호출하려면 누르세요",fd="요청 확인",hd="프론트 데스크로 보내기",xd={welcome:Tc,start:Rc,language:Dc,english:Oc,french:Ic,russian:Mc,korean:Pc,send:Lc,cancel:Fc,confirm_request:qc,room:Vc,order_id:zc,guest_name:Bc,content:Hc,time:Wc,status:Uc,action:Kc,message_guest:Gc,request_management:Jc,login:Xc,username:Qc,password:Yc,hotel_name:Zc,hotel_subtitle:el,press_to_call:tl,room_and_stay:nl,room_services:sl,bookings_and_facilities:ol,tourism_and_exploration:rl,support_external_services:al,order_ref:il,requested_at:cl,estimated_completion:ll,time_remaining:dl,mute:ul,unmute:ml,confirm:_l,need_conversation:gl,tap_to_speak:pl,order_summary:fl,send_to_reception:hl,add_note:xl,room_number:bl,enter_room_number:vl,enter_notes:yl,summary:$l,generated_at:wl,order_confirmed:jl,order_confirmed_message:Nl,order_reference:Sl,estimated_delivery_time:Cl,return_to_home:kl,press_to_call_desc:Al,confirm_request_desc:El,send_to_reception_desc:Tl,status_acknowledged:Rl,status_in_progress:Dl,status_delivering:Ol,status_completed:Il,status_note:Ml,icon_login:Pl,icon_hourglass_empty:Ll,icon_info:Fl,icon_policy:ql,icon_wifi:Vl,icon_restaurant:zl,icon_local_bar:Bl,icon_cleaning_services:Hl,icon_local_laundry_service:Wl,icon_alarm:Ul,icon_add_circle:Kl,icon_build:Gl,icon_event_seat:Jl,icon_spa:Xl,icon_fitness_center:Ql,icon_pool:Yl,icon_directions_car:Zl,icon_medical_services:ed,icon_support_agent:td,icon_location_on:nd,icon_local_dining:sd,icon_directions_bus:od,icon_event:rd,icon_shopping_bag:ad,icon_map:id,icon_translate:cd,icon_rate_review:ld,icon_report_problem:dd,icon_luggage:ud,onboarding_title:md,onboarding_description:_d,start_using:gd,onboarding_step1:pd,onboarding_step2:fd,onboarding_step3:hd},bd={en:fs,fr:sr,zh:Ba,ru:Ec,ko:xd};function w(t,n="en"){return bd[n][t]||t}const xe=o.memo(({step:t,index:n,currentStep:s,compact:c,horizontal:a})=>{const l=n+1===s,d=n+1<s,i=o.useMemo(()=>({width:a?22:c?32:48,height:a?22:c?32:48,fontSize:a?13:c?18:28}),[a,c]),_=o.useMemo(()=>`
    flex items-center justify-center rounded-full shadow-lg transition-all duration-300
    ${l?"bg-[#d4af37] text-blue-900 border-2 border-[#d4af37]":"bg-white/30 text-white border border-gray-200"}
  `,[l]),p=o.useMemo(()=>`
    font-semibold font-poppins mb-1
    ${a?"text-[10px]":c?"text-xs":"text-base"}
    ${l?"text-white":"text-white/70"}
  `,[a,c,l]),h=o.useMemo(()=>`
    font-light
    ${a?"text-[8px]":c?"text-[10px]":"text-sm"}
    text-white/80
    ${a?"hidden md:block":""}
  `,[a,c]),g=o.useMemo(()=>`
    flex flex-col items-center transition-all duration-300
    ${l?"opacity-100 scale-105":d?"opacity-60":"opacity-40"}
    ${a?"w-auto":"w-full"}
  `,[l,d,a]);return e.jsxs("div",{className:g,children:[e.jsx("div",{className:_,style:i,children:e.jsx("span",{className:"material-icons","aria-hidden":"true",children:t.icon})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:p,children:t.title}),e.jsx("div",{className:h,children:t.desc})]})]})}),vd=o.memo(({currentStep:t=1,compact:n=!1,horizontal:s=!1,language:c})=>{const{language:a}=J?J():{language:"en"},l=c||a||"en",d=o.useMemo(()=>[{icon:"call",title:w("press_to_call",l),desc:w("press_to_call_desc",l)},{icon:"check_circle",title:w("confirm_request",l),desc:w("confirm_request_desc",l)},{icon:"mail",title:w("send_to_reception",l),desc:w("send_to_reception_desc",l)}],[l]);return s?e.jsx("div",{className:"flex flex-row items-center justify-center w-full gap-2 md:gap-6 py-1",role:"list","aria-label":w("process_steps",l),children:d.map((i,_)=>e.jsxs(q.Fragment,{children:[e.jsx("div",{role:"listitem","aria-current":_+1===t?"step":void 0,children:e.jsx(xe,{step:i,index:_,currentStep:t,horizontal:s})}),_<d.length-1&&e.jsx("div",{className:"h-0.5 w-3 md:w-8 bg-gradient-to-r from-[#d4af37]/80 to-transparent mx-1 rounded-full","aria-hidden":"true"})]},i.title))}):e.jsx("div",{className:`w-full ${n?"max-w-[160px] py-2 gap-3":"max-w-xs py-6 gap-6"} mx-auto flex flex-col items-center`,role:"list","aria-label":w("process_steps",l),children:d.map((i,_)=>e.jsxs("div",{role:"listitem","aria-current":_+1===t?"step":void 0,children:[e.jsx(xe,{step:i,index:_,currentStep:t,compact:n}),_<d.length-1&&e.jsx("div",{className:`mx-auto my-1 rounded-full ${n?"w-0.5 h-4":"w-1 h-8"} bg-gradient-to-b from-[#d4af37]/80 to-transparent`,"aria-hidden":"true"})]},i.title))})});function Ve(){const[t,n]=o.useState(null),[s,c]=o.useState(!1),{callDetails:a,addTranscript:l}=J(),d=o.useRef(0),i=o.useCallback(()=>{console.log("useWebSocket env VITE_API_HOST:",void 0),t!==null&&t.close();const g=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;console.log("Attempting WebSocket connection to",g);const v=new WebSocket(g);return v.onopen=()=>{console.log("WebSocket connection established"),c(!0),d.current=0,a&&v.send(JSON.stringify({type:"init",callId:a.id}))},v.onmessage=b=>{try{const y=JSON.parse(b.data);y.type==="transcript"&&l({callId:y.callId,role:y.role,content:y.content})}catch(y){console.error("Error parsing WebSocket message:",y)}},v.onclose=b=>{if(console.log("WebSocket connection closed",b),c(!1),d.current<5){const y=Math.pow(2,d.current)*1e3;console.log(`Reconnecting WebSocket in ${y}ms (attempt ${d.current+1})`),setTimeout(i,y),d.current++}else console.warn("Max WebSocket reconnection attempts reached")},v.onerror=b=>{console.error("WebSocket encountered error",b),v.readyState!==WebSocket.CLOSED&&v.close()},n(v),()=>{v.close()}},[a,l]),_=o.useCallback(h=>{t&&s?t.send(JSON.stringify(h)):console.error("Cannot send message, WebSocket not connected")},[t,s]),p=o.useCallback(()=>{s||i()},[s,i]);return o.useEffect(()=>(i(),()=>{t&&t.close()}),[]),o.useEffect(()=>{t&&s&&(a!=null&&a.id)&&(console.log("Sending init message with callId after availability",a.id),t.send(JSON.stringify({type:"init",callId:a.id})))},[a==null?void 0:a.id,t,s]),{connected:s,sendMessage:_,reconnect:p}}const yd=({src:t,alt:n,className:s,fallbackSrc:c="/placeholder.webp",loading:a="lazy",width:l,height:d,...i})=>{const[_,p]=o.useState(t),[h,g]=o.useState(!0),[v,b]=o.useState(!1);o.useEffect(()=>{p(t),g(!0),b(!1)},[t]);const y=()=>{v||(b(!0),p(c))};return e.jsxs("div",{className:$("relative overflow-hidden",s),children:[h&&e.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse"}),e.jsx("img",{src:_,alt:n,loading:a,width:l,height:d,onLoad:()=>g(!1),onError:y,className:$("transition-opacity duration-300",h?"opacity-0":"opacity-100",s),...i})]})},$d=nt,wd=et,ze=o.forwardRef(({className:t,...n},s)=>e.jsx(Ce,{ref:s,className:$("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));ze.displayName=Ce.displayName;const Be=o.forwardRef(({className:t,children:n,...s},c)=>e.jsxs(wd,{children:[e.jsx(ze,{}),e.jsxs(ke,{ref:c,className:$("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[n,e.jsxs(tt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Re,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Be.displayName=ke.displayName;const He=({className:t,...n})=>e.jsx("div",{className:$("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});He.displayName="DialogHeader";const We=({className:t,...n})=>e.jsx("div",{className:$("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});We.displayName="DialogFooter";const Ue=o.forwardRef(({className:t,...n},s)=>e.jsx(Ae,{ref:s,className:$("text-lg font-semibold leading-none tracking-tight",t),...n}));Ue.displayName=Ae.displayName;const Ke=o.forwardRef(({className:t,...n},s)=>e.jsx(Ee,{ref:s,className:$("text-sm text-muted-foreground",t),...n}));Ke.displayName=Ee.displayName;const jd=Te("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ge=o.forwardRef(({className:t,variant:n,size:s,asChild:c=!1,...a},l)=>{const d=c?st:"button";return e.jsx(d,{className:$(jd({variant:n,size:s,className:t})),ref:l,...a})});Ge.displayName="Button";const ue={primary:"#79DBDC",light:"#E2FFFF",lighter:"#C6FFFF"},Nd=()=>{const t=J(),n=(t==null?void 0:t.language)||"en",[s,c]=o.useState(!1);o.useEffect(()=>{localStorage.getItem("hasSeenOnboarding")||c(!0)},[]);const a=()=>{c(!1),localStorage.setItem("hasSeenOnboarding","true")},l=()=>c(!0);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:l,className:"fixed top-4 right-4 z-[60] bg-white/90 hover:bg-[#E2FFFF] text-[#559A9A] rounded-full shadow-lg p-2 transition-colors","aria-label":"Show Guide",style:{fontSize:28},children:e.jsx(lt,{})}),e.jsxs($d,{open:s,onOpenChange:c,children:[s?e.jsx("div",{className:"fixed inset-0 z-40 bg-[#559A9A]/40"}):null,e.jsxs(Be,{className:"sm:max-w-md z-50 rounded-2xl shadow-2xl border-0 p-0 min-h-[480px] max-h-[90vh] overflow-y-auto",style:{background:`linear-gradient(135deg, ${ue.light} 60%, ${ue.lighter})`},children:[e.jsxs(He,{className:"items-center text-center",children:[e.jsx(Ue,{className:"text-2xl font-bold text-[#559A9A] mb-1",children:w("onboarding_title",n)}),e.jsx(Ke,{className:"text-base text-[#559A9A] mb-2",children:w("onboarding_description",n)})]}),e.jsxs("div",{className:"flex flex-col items-center py-6 gap-6 w-full",children:[e.jsxs("div",{className:"flex flex-col items-center w-full px-4 py-2 bg-white/80 rounded-xl shadow border border-[#E2FFFF]",children:[e.jsx("div",{className:"rounded-full bg-[#79DBDC] shadow-lg flex items-center justify-center mb-2",style:{width:56,height:56},children:e.jsx(dt,{size:28,color:"#fff"})}),e.jsx("span",{className:"text-[#559A9A] font-semibold text-base text-center",children:w("onboarding_step1",n)})]}),e.jsxs("div",{className:"flex flex-col items-center w-full px-4 py-2 bg-white/80 rounded-xl shadow border border-[#E2FFFF]",children:[e.jsx("div",{className:"rounded-full bg-[#79DCDC] shadow-lg flex items-center justify-center mb-2",style:{width:56,height:56},children:e.jsx(ut,{size:28,color:"#fff"})}),e.jsx("span",{className:"text-[#559A9A] font-semibold text-base text-center",children:w("onboarding_step2",n)})]}),e.jsxs("div",{className:"flex flex-col items-center w-full px-4 py-2 bg-white/80 rounded-xl shadow border border-[#E2FFFF]",children:[e.jsx("div",{className:"rounded-full bg-[#C6FFFF] shadow-lg flex items-center justify-center mb-2",style:{width:56,height:56},children:e.jsx(mt,{size:28,color:"#559A9A"})}),e.jsx("span",{className:"text-[#559A9A] font-semibold text-base text-center",children:w("onboarding_step3",n)})]})]}),e.jsx(We,{className:"flex justify-end",children:e.jsx(Ge,{onClick:a,className:"px-6 py-2 text-base font-semibold rounded-lg shadow-md",style:{background:ue.primary,color:"#fff"},children:w("start_using",n)})})]})]})]})},Sd=6e4,Cd=()=>{const[t,n]=o.useState(!1),[s,c]=o.useState(null);return o.useEffect(()=>{let a=null;const l=async()=>{try{const _=await(await fetch("/version.txt",{cache:"no-store"})).text();a?_.trim()!==a&&(c(_.trim()),n(!0)):a=_.trim()}catch{}};l();const d=setInterval(l,Sd);return()=>clearInterval(d)},[]),t?e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 max-w-xs text-center",children:[e.jsx("div",{className:"text-lg font-semibold mb-2 text-[#559A9A]",children:"A new update is available!"}),e.jsx("div",{className:"mb-4 text-gray-600",children:"Please refresh the page to get the latest version."}),e.jsx("button",{className:"px-4 py-2 rounded-lg bg-[#79DBDC] text-white font-bold shadow",onClick:()=>window.location.reload(),children:"Refresh Now"})]})}):null},kd=o.lazy(()=>A(()=>import("./Interface1-DvttRbJG.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]))),Ad=o.lazy(()=>A(()=>import("./Interface2-c2s3JLeu.js"),__vite__mapDeps([28,1,2,29,30,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]))),Ed=o.lazy(()=>A(()=>import("./Interface3-BcwZLjSP.js"),__vite__mapDeps([31,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,3,24,25,26,27]))),Td=o.lazy(()=>A(()=>import("./Interface3Vi-fkj_qHBx.js"),__vite__mapDeps([32,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,3,24,25,26,27]))),Rd=o.lazy(()=>A(()=>import("./Interface3Fr-CSF8biqW.js"),__vite__mapDeps([33,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,3,24,25,26,27]))),Dd=o.lazy(()=>A(()=>import("./Interface4-jMep-S7x.js"),__vite__mapDeps([34,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,3,24,25,26,27]))),Od=o.memo(()=>e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-gray-400",children:"Đang tải giao diện..."})]})})),Id=o.memo(({currentInterface:t,language:n})=>e.jsx("header",{className:"w-full bg-primary text-white p-4 shadow-md",children:e.jsxs("div",{className:"container mx-auto flex items-center justify-between px-2",children:[e.jsx("div",{className:"w-16 flex-shrink-0 flex items-center justify-start ml-1 sm:ml-4 mr-2 sm:mr-6",children:e.jsx(yd,{src:"/assets/references/images/minhon-logo.jpg",alt:"Minhon Logo",className:"h-10 sm:h-14 w-auto rounded-lg shadow-md bg-white/80 p-1",loading:"eager"})}),e.jsx("div",{className:"flex-1 flex justify-center",children:e.jsx("div",{className:"w-full max-w-xs sm:max-w-md",children:e.jsx(vd,{horizontal:!0,compact:!0,currentStep:t==="interface3"?3:t==="interface2"?2:1,language:n})})}),e.jsx("div",{className:"w-10 flex-shrink-0 flex items-center justify-end ml-2 sm:ml-6 mr-1 sm:mr-2",children:e.jsx(ve,{href:"/call-history",children:e.jsxs("a",{className:"flex items-center gap-1 px-2 py-1 rounded bg-primary-dark text-white text-xs sm:text-sm hover:bg-primary-darker transition-colors","aria-label":"View Call History",children:[e.jsx(at,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{className:"hidden sm:inline",children:"Call History"})]})})})]})})),Md=o.memo(({currentInterface:t})=>e.jsx("div",{className:"relative w-full h-full",id:"interfaceContainer",children:e.jsx(De,{children:e.jsxs(o.Suspense,{fallback:e.jsx(Od,{}),children:[e.jsx(kd,{isActive:t==="interface1"}),e.jsx(Ad,{isActive:t==="interface2"}),e.jsx(Ed,{isActive:t==="interface3"}),e.jsx(Td,{isActive:t==="interface3vi"}),e.jsx(Rd,{isActive:t==="interface3fr"}),e.jsx(Dd,{isActive:t==="interface4"})]})})})),Pd=()=>{const t=J(),n=(t==null?void 0:t.currentInterface)||"interface1",s=(t==null?void 0:t.language)||"en";return Ve(),e.jsxs("div",{className:"relative h-screen overflow-hidden font-sans text-gray-800 bg-neutral-50",id:"app",role:"application","aria-label":"Voice Assistant",children:[e.jsx(Cd,{}),e.jsx(Nd,{}),e.jsx(Id,{currentInterface:n,language:s}),e.jsx(Md,{currentInterface:n})]})},Ld=o.memo(Pd),Je=o.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:$("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n}));Je.displayName="Card";const Fd=o.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:$("flex flex-col space-y-1.5 p-6",t),...n}));Fd.displayName="CardHeader";const qd=o.forwardRef(({className:t,...n},s)=>e.jsx("h3",{ref:s,className:$("text-2xl font-semibold leading-none tracking-tight",t),...n}));qd.displayName="CardTitle";const Vd=o.forwardRef(({className:t,...n},s)=>e.jsx("p",{ref:s,className:$("text-sm text-muted-foreground",t),...n}));Vd.displayName="CardDescription";const Xe=o.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:$("p-6 pt-0",t),...n}));Xe.displayName="CardContent";const zd=o.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:$("flex items-center p-6 pt-0",t),...n}));zd.displayName="CardFooter";function Bd(){return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:e.jsx(Je,{className:"w-full max-w-md mx-4",children:e.jsxs(Xe,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx(it,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const Hd=()=>{const[t,n]=o.useState(!1),[s,c]=o.useState(null),[a,l]=o.useState(null),[d,i]=o.useState("tuans2@gmail.com"),_=async()=>{try{n(!0),c(null),l(null),console.log("Sending test email to:",d);const p=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);console.log("Device type:",p?"mobile":"desktop");try{const g=await(await fetch("/api/test-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({toEmail:d,isMobile:p}),cache:"no-cache"})).json();if(g.success){c(`Email sent successfully using standard method! Provider: ${g.provider||"unknown"}`),n(!1);return}else console.warn("Standard method failed, trying mobile-specific endpoint")}catch(h){console.error("Error with standard endpoint:",h)}try{console.log("Thử sử dụng endpoint dành riêng cho di động...");const h=/iPhone|iPad|iPod|Android|Mobile|webOS|BlackBerry/i.test(navigator.userAgent),g=new Date().getTime(),b=await(await fetch(`/api/mobile-test-email?_=${g}`,{method:"POST",headers:{"Content-Type":"application/json","X-Device-Type":h?"mobile":"desktop","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},body:JSON.stringify({toEmail:d,timestamp:g,deviceInfo:navigator.userAgent}),cache:"no-cache",credentials:"same-origin",keepalive:!0})).json();if(b.success)c(`Email đang được xử lý qua endpoint tối ưu hóa cho ${h?"di động":"desktop"}! Vui lòng kiểm tra hộp thư sau vài giây.`),console.log(`Đã gửi yêu cầu thành công đến ${h?"mobile":"desktop"} endpoint.`),console.log("Response:",b);else throw new Error(b.error||"Lỗi không xác định với endpoint di động")}catch(h){console.error("Chi tiết lỗi mobile endpoint:",h),l(`Không thể gửi email: ${(h==null?void 0:h.message)||"Lỗi không xác định"}`)}n(!1)}catch(p){console.error("Error sending test email:",p),l(`Error: ${(p==null?void 0:p.message)||"Unknown error"}`),n(!1)}};return e.jsxs("div",{className:"p-4 border rounded-lg shadow-md bg-white max-w-md mx-auto mt-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-primary",children:"Kiểm tra Email trên Di động"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email người nhận:"}),e.jsx("input",{type:"email",value:d,onChange:p=>i(p.target.value),className:"w-full p-2 border rounded focus:ring-2 focus:ring-primary",placeholder:"example@gmail.com"})]}),e.jsx("button",{onClick:_,disabled:t,className:`w-full p-3 rounded font-medium text-white ${t?"bg-gray-400":"bg-primary hover:bg-primary/90"}`,children:t?"Đang gửi...":"Gửi Email Kiểm tra"}),s&&e.jsx("div",{className:"mt-4 p-3 bg-green-100 text-green-800 rounded",children:s}),a&&e.jsx("div",{className:"mt-4 p-3 bg-red-100 text-red-800 rounded",children:a}),e.jsx("div",{className:"mt-4 text-sm text-gray-500",children:e.jsx("p",{children:"* Công cụ này giúp kiểm tra việc gửi email trên thiết bị di động. Nếu phương thức tiêu chuẩn không hoạt động, hệ thống sẽ tự động thử phương thức tối ưu hóa cho di động."})})]})},Wd=({onLogin:t})=>{const[n,s]=o.useState(""),[c,a]=o.useState(""),[l,d]=o.useState(""),i=async _=>{if(_.preventDefault(),!n||!c){d("Please enter both username and password.");return}d("");try{const p=await fetch("/api/staff/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:c})});if(!p.ok){const g=await p.json();d(g.error||"Login failed.");return}const h=await p.json();h.token?(localStorage.setItem("staff_token",h.token),t()):d("Login failed: No token received.")}catch{d("Login failed: Network or server error.")}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 to-blue-300",children:e.jsxs("form",{onSubmit:i,className:"bg-white p-8 rounded-xl shadow-lg w-full max-w-md space-y-6 border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-4 text-center",children:"Staff Login"}),l&&e.jsx("div",{className:"text-red-500 text-sm mb-2",children:l}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Username"}),e.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400",value:n,onChange:_=>s(_.target.value),autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Password"}),e.jsx("input",{type:"password",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400",value:c,onChange:_=>a(_.target.value)})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-700 hover:bg-blue-800 text-white font-semibold py-2 rounded-lg transition",children:"Login"})]})})},Ud=["Đã ghi nhận","Đang thực hiện","Đã thực hiện và đang bàn giao cho khách","Hoàn thiện","Lưu ý khác"],Kd=({request:t,onClose:n,onStatusChange:s,onOpenMessage:c})=>{const[a,l]=o.useState(t.status);return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-blue-700",onClick:n,children:"×"}),e.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-4",children:"Request Details"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Room:"})," ",t.room]}),e.jsxs("div",{children:[e.jsx("b",{children:"Order ID:"})," ",t.id]}),e.jsxs("div",{children:[e.jsx("b",{children:"Guest Name:"})," ",t.guestName]}),e.jsxs("div",{children:[e.jsx("b",{children:"Content:"})," ",t.content]}),e.jsxs("div",{children:[e.jsx("b",{children:"Time:"})," ",t.time]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("b",{children:"Status:"}),e.jsx("select",{className:"border rounded px-2 py-1 text-xs",value:a,onChange:d=>l(d.target.value),children:Ud.map(d=>e.jsx("option",{value:d,children:d},d))})]}),e.jsxs("div",{children:[e.jsx("b",{children:"Notes:"})," ",t.notes||"-"]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded font-semibold",onClick:()=>{a!==t.status&&s(a)},children:"Cập Nhật"}),e.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded font-semibold",onClick:c,children:"Nhắn khách"}),e.jsx("button",{className:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded font-semibold",onClick:n,children:"Đóng"})]})]})}):null},Gd=({messages:t,onSend:n,onClose:s,loading:c})=>{const[a,l]=o.useState(""),d=()=>{a.trim()&&(n(a),l(""))};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-5 w-full max-w-md relative flex flex-col",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-blue-700",onClick:s,children:"×"}),e.jsx("h3",{className:"text-lg font-bold text-blue-900 mb-3",children:"Nhắn tin tới Guest"}),e.jsx("div",{className:"flex-1 overflow-y-auto mb-3 max-h-60 border rounded p-2 bg-gray-50",children:t.length===0?e.jsx("div",{className:"text-gray-400 text-sm text-center",children:"Chưa có tin nhắn"}):t.map(i=>e.jsxs("div",{className:`mb-2 ${i.sender==="staff"?"text-right":"text-left"}`,children:[e.jsxs("div",{className:`inline-block px-3 py-1 rounded-lg ${i.sender==="staff"?"bg-blue-100 text-blue-900":"bg-gray-200 text-gray-800"}`,children:[e.jsxs("span",{className:"font-semibold",children:[i.sender==="staff"?"Staff":"Guest",":"]})," ",i.content]}),e.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:i.time})]},i.id))}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("input",{type:"text",className:"flex-1 border rounded px-2 py-1",placeholder:"Nhập tin nhắn...",value:a,onChange:i=>l(i.target.value),onKeyDown:i=>{i.key==="Enter"&&d()},disabled:c}),e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-1 rounded font-semibold",onClick:d,disabled:c||!a.trim(),children:"Gửi"})]})]})})},me=["Tất cả","Đã ghi nhận","Đang thực hiện","Đã thực hiện và đang bàn giao cho khách","Hoàn thiện","Lưu ý khác"],be=t=>{switch(t){case"Đã ghi nhận":return"bg-gray-300 text-gray-800";case"Đang thực hiện":return"bg-yellow-200 text-yellow-800";case"Đã thực hiện và đang bàn giao cho khách":return"bg-blue-200 text-blue-800";case"Hoàn thiện":return"bg-green-200 text-green-800";case"Lưu ý khác":return"bg-red-200 text-red-800";default:return"bg-gray-100 text-gray-700"}},Jd=q.lazy(()=>A(()=>import("./StaffRequestTable-DHRf05Hf.js"),__vite__mapDeps([35,1,2]))),Xd=()=>{const[t,n]=o.useState([]),[s,c]=o.useState(null),[a,l]=o.useState(!1),[d,i]=o.useState(!1),[_,p]=o.useState([]),[h,g]=o.useState(!1),[v,b]=o.useState("Tất cả"),[y,P]=o.useState(""),[R,X]=o.useState(""),[S,se]=o.useState(null),[k,Q]=o.useState(!1),[Y,D]=o.useState(!1),[V,z]=o.useState(""),[L,O]=o.useState(""),[B,H]=o.useState({}),E=_t(),I=()=>localStorage.getItem("staff_token"),M=async()=>{const r=I();if(!r){E("/staff");return}try{const u=await fetch("/api/staff/requests",{headers:{Authorization:`Bearer ${r}`},credentials:"include"});if(u.status===401){localStorage.removeItem("staff_token"),E("/staff");return}const m=await u.json();console.log("Fetched requests data:",m),n(m)}catch(u){console.error("Failed to fetch requests:",u)}};o.useEffect(()=>{M();const r=setInterval(M,3e4);return()=>clearInterval(r)},[]);const j=()=>{l(!1),c(null)},W=async(r,u)=>{const m=I();if(!m)return E("/staff");try{await fetch(`/api/staff/requests/${u}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`},credentials:"include",body:JSON.stringify({status:r})}),n(C=>C.map(f=>f.id===u?{...f,status:r}:f)),s&&s.id===u&&c({...s,status:r})}catch(C){console.error("Failed to update status:",C)}},U=async()=>{if(i(!0),!s)return;const r=I();if(!r)return E("/staff");try{const m=await(await fetch(`/api/staff/requests/${s.id}/messages`,{headers:{Authorization:`Bearer ${r}`},credentials:"include"})).json();p(m)}catch{p([])}},oe=()=>i(!1),re=async r=>{g(!0);const u=I();if(!u)return E("/staff");try{await fetch(`/api/staff/requests/${s.id}/message`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},credentials:"include",body:JSON.stringify({content:r})}),p(m=>[...m,{id:(m.length+1).toString(),sender:"staff",content:r,time:new Date().toLocaleTimeString().slice(0,5)}])}catch{}g(!1)},ae=async()=>{D(!0),z(""),O("")},Z=async()=>{if(V!=="2208"){O("Mật khẩu không đúng");return}Q(!0);try{const r=I();if(!r)return D(!1),E("/staff");const m=await(await fetch("/api/staff/requests/all",{method:"DELETE",headers:{Authorization:`Bearer ${r}`},credentials:"include"})).json();D(!1),m.success?(alert(`${m.message}`),n([])):alert(`Lỗi: ${m.error||"Không thể xóa requests"}`)}catch(r){console.error("Error deleting all requests:",r),alert("Đã xảy ra lỗi khi xóa requests"),D(!1)}finally{Q(!1),z("")}},K=t.filter(r=>{if(v!=="Tất cả"&&r.status!==v)return!1;if(y||R){const u=new Date(r.created_at);if(y){const m=new Date(y);if(m.setHours(0,0,0,0),u<m)return!1}if(R){const m=new Date(R);if(m.setHours(23,59,59,999),u>m)return!1}}return!0}),_e=r=>{r.key==="Enter"&&Z(),L&&O("")},ie=r=>{r.stopPropagation()};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-200 p-2 sm:p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto bg-white rounded-xl shadow-lg p-3 sm:p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("img",{src:"/assets/references/images/minhon-logo.jpg",alt:"Minhon Logo",className:"h-16 object-contain mb-2"}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-900 text-center",children:"Staff Request Management"})]}),e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("button",{onClick:ae,disabled:k||t.length===0,className:`w-auto bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded font-semibold ${k||t.length===0?"opacity-50 cursor-not-allowed":""}`,children:k?"Đang xóa...":"Xóa tất cả Requests"}),e.jsx("button",{onClick:M,className:"w-auto bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded font-semibold",children:"Refresh"})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[e.jsx("label",{className:"font-semibold text-blue-900 w-full sm:w-auto",children:"Lọc theo trạng thái:"}),e.jsx("select",{className:"w-full sm:w-auto border rounded px-3 py-1 text-sm",value:v,onChange:r=>b(r.target.value),children:me.map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[e.jsx("label",{className:"font-semibold text-blue-900 w-full sm:w-auto",children:"Lọc theo thời gian:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx("label",{className:"text-sm text-gray-600 min-w-10",children:"Từ:"}),e.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm w-full",value:y,onChange:r=>P(r.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx("label",{className:"text-sm text-gray-600 min-w-10",children:"Đến:"}),e.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm w-full",value:R,onChange:r=>X(r.target.value)})]}),(y||R)&&e.jsx("button",{onClick:()=>{P(""),X("")},className:"text-blue-600 hover:text-blue-800 text-sm mt-2 sm:mt-0",children:"Xóa lọc"})]})]})]}),e.jsx("div",{className:"block sm:hidden",children:e.jsxs("div",{className:"space-y-4",children:[(console.log("Mobile rendering - filteredRequests:",K),null),K.length>0?[...K].sort((r,u)=>new Date(u.created_at).getTime()-new Date(r.created_at).getTime()).map(r=>e.jsxs("div",{className:"border rounded-lg p-3 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsxs("div",{className:"font-semibold",children:["Phòng: ",r.room_number||"N/A"]}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-semibold ${be(r.status)}`,children:r.status||"Chưa xác định"})]}),e.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:["Order ID: ",r.orderId||r.id||"N/A"]}),e.jsx("div",{className:"text-xs text-gray-500 mb-3",children:r.created_at?e.jsxs(e.Fragment,{children:[new Date(r.created_at).toLocaleDateString()," ",new Date(r.created_at).toLocaleTimeString()]}):"Thời gian không xác định"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("button",{onClick:()=>se(S===r.id?null:r.id),className:"w-full flex justify-between items-center py-1 px-2 border rounded bg-gray-50 hover:bg-gray-100",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700",children:S===r.id?"Ẩn nội dung":"Xem nội dung"}),e.jsx("svg",{className:`w-4 h-4 text-blue-700 transition-transform ${S===r.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),S===r.id&&e.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded-md whitespace-pre-line break-words text-sm",children:r.request_content||"Không có nội dung"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("select",{className:"border rounded px-2 py-2 text-sm w-full",value:B[r.id]??r.status,onChange:u=>H(m=>({...m,[r.id]:u.target.value})),children:me.filter(u=>u!=="Tất cả").map(u=>e.jsx("option",{value:u,children:u},u))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-2 py-2 rounded text-sm font-semibold",onClick:async()=>{const u=B[r.id];u&&u!==r.status&&(await W(u,r.id),H(m=>{const{[r.id]:C,...f}=m;return f}))},children:"Cập Nhật"}),e.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-2 py-2 rounded text-sm font-semibold",onClick:()=>{c(r),U()},children:"Nhắn khách"})]})]})]},r.id)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"Không có yêu cầu nào"}),e.jsx("p",{className:"mt-2 text-sm",children:"Nhấn Refresh để tải lại dữ liệu"})]})]})}),e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"hidden sm:block text-center py-8 text-gray-500",children:"Đang tải bảng..."}),children:e.jsx(Jd,{filteredRequests:K,pendingStatus:B,setPendingStatus:H,statusOptions:me,handleStatusChange:W,setSelectedRequest:c,handleOpenMessage:U,statusColor:be})})]}),a&&s&&e.jsx(Kd,{request:s,onClose:j,onStatusChange:r=>W(r,s.id),onOpenMessage:U}),d&&s&&e.jsx(Gd,{messages:_,onClose:oe,onSend:re,loading:h}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md mx-4",onClick:ie,children:[e.jsx("h3",{className:"text-lg font-bold text-red-600 mb-4",children:"Xác nhận xóa toàn bộ requests"}),e.jsx("p",{className:"mb-4 text-gray-700",children:"Hành động này sẽ xóa tất cả requests và không thể hoàn tác. Vui lòng nhập mật khẩu để xác nhận:"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("input",{type:"password",value:V,onChange:r=>z(r.target.value),onKeyDown:_e,className:`w-full px-3 py-2 border rounded ${L?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-red-500`,placeholder:"Nhập mật khẩu xác nhận",autoFocus:!0}),L&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:L}),e.jsx("p",{className:"text-gray-500 text-xs mt-2 italic",children:"Biện pháp bảo vệ: Chức năng xóa yêu cầu mật khẩu xác nhận để ngăn ngừa xóa dữ liệu do nhầm lẫn."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>D(!1),className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded transition duration-200",children:"Hủy"}),e.jsx("button",{onClick:Z,disabled:k,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded transition duration-200 flex items-center disabled:opacity-70",children:k?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xóa..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Xác nhận xóa"]})})]})]})})]})},Qd=()=>{const[t,n]=o.useState(!1),s=()=>n(!0);return t?e.jsx(Xd,{}):e.jsx(Wd,{onLogin:s})},Yd=q.lazy(()=>A(()=>import("./CallHistory-CIRaBg0a.js"),__vite__mapDeps([36,1,2,27,6,7,8,4,5,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,3,24,25,26]))),Zd=q.lazy(()=>A(()=>import("./CallDetails-CHM_Q-IP.js"),__vite__mapDeps([37,1,2,27,6,7,8]))),eu=()=>e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Đang tải..."})]})}),tu=()=>e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Kiểm tra Tính năng Email"}),e.jsx(ve,{href:"/",className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90",children:"Quay lại Trang Chính"})]}),e.jsx(Hd,{})]})});function nu(){return e.jsx(o.Suspense,{fallback:e.jsx(eu,{}),children:e.jsxs(Ye,{children:[e.jsx(F,{path:"/call-history",component:Yd}),e.jsx(F,{path:"/call-details/:callId",component:Zd}),e.jsx(F,{path:"/email-test",component:tu}),e.jsx(F,{path:"/staff",component:Qd}),e.jsx(F,{path:"/",component:Ld}),e.jsx(F,{component:Bd})]})})}function su(){return Ve(),e.jsx(gt,{children:e.jsx(qe,{children:e.jsxs(De,{children:[e.jsx(nu,{}),e.jsx(kt,{})]})})})}async function ou(t){if(!t.ok){const n=await t.text()||t.statusText;throw new Error(`${t.status}: ${n}`)}}const ru=({on401:t})=>async({queryKey:n})=>{const s=await fetch(n[0],{credentials:"include"});return await ou(s),await s.json()},au=new pt({defaultOptions:{queries:{queryFn:ru({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}});Qe(document.getElementById("root")).render(e.jsx(ft,{client:au,children:e.jsx(qe,{children:e.jsx(su,{})})}));export{yd as I,A as _,Et as i,w as t,J as u};
//# sourceMappingURL=index-B87HseW6.js.map
